{"version":3,"sources":["../../../../../../../../XUI/org/forgerock/openam/ui/admin/models/authorization/PolicyModel.js"],"names":["define","_","Backbone","URLHelper","ModelUtils","Model","extend","idAttribute","urlRoot","substitute","defaults","name","description","resources","actionValues","validate","attrs","trim","indexOf","length","sync","method","model","options","beforeSend","xhr","setRequestHeader","error","errorHandler","id","url","prototype","call"],"mappings":";;AAAA;;;;;;;;;;;;;;;;AAgBAA,OAAO,CACH,QADG,EAEH,UAFG,EAGH,+CAHG,EAIH,gDAJG,CAAP,EAKG,UAAUC,CAAV,EAAaC,QAAb,EAAuBC,SAAvB,EAAkCC,UAAlC,EAA8C;AAC7C,WAAOF,SAASG,KAAT,CAAeC,MAAf,CAAsB;AACzBC,qBAAa,MADY;AAEzBC,iBAASL,UAAUM,UAAV,CAAqB,kBAArB,CAFgB;;AAIzBC,gBAJyB,sBAIb;AACR,mBAAO;AACHC,sBAAM,IADH;AAEHC,6BAAa,EAFV;AAGHC,2BAAW,EAHR;AAIHC,8BAAc;AAJX,aAAP;AAMH,SAXwB;AAazBC,gBAbyB,oBAafC,KAbe,EAaR;AACb,gBAAIA,MAAML,IAAN,CAAWM,IAAX,OAAsB,EAA1B,EAA8B;AAC1B,uBAAO,aAAP;AACH;;AAED;AACA,gBAAID,MAAML,IAAN,CAAWO,OAAX,CAAmB,GAAnB,MAA4B,CAAhC,EAAmC;AAC/B,uBAAO,wBAAP;AACH;;AAED,gBAAIF,MAAMH,SAAN,CAAgBM,MAAhB,KAA2B,CAA/B,EAAkC;AAC9B,uBAAO,wBAAP;AACH;AACJ,SA1BwB;AA4BzBC,YA5ByB,gBA4BnBC,MA5BmB,EA4BXC,KA5BW,EA4BJC,OA5BI,EA4BK;AAC1BA,sBAAUA,WAAW,EAArB;AACAA,oBAAQC,UAAR,GAAqB,UAAUC,GAAV,EAAe;AAChCA,oBAAIC,gBAAJ,CAAqB,oBAArB,EAA2C,2BAA3C;AACH,aAFD;AAGAH,oBAAQI,KAAR,GAAgBvB,WAAWwB,YAA3B;;AAEA,gBAAIN,MAAMO,EAAN,KAAa,IAAjB,EAAuB;AACnBR,yBAAS,QAAT;AACAE,wBAAQO,GAAR,GAAiB,KAAKtB,OAAL,EAAjB;AACH;;AAED,mBAAON,SAASG,KAAT,CAAe0B,SAAf,CAAyBX,IAAzB,CAA8BY,IAA9B,CAAmC,IAAnC,EAAyCX,MAAzC,EAAiDC,KAAjD,EAAwDC,OAAxD,CAAP;AACH;AAzCwB,KAAtB,CAAP;AA2CH,CAjDD","file":"PolicyModel.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2015-2017 ForgeRock AS.\n */\n\ndefine([\n    \"lodash\",\n    \"backbone\",\n    \"org/forgerock/openam/ui/common/util/URLHelper\",\n    \"org/forgerock/openam/ui/admin/utils/ModelUtils\"\n], function (_, Backbone, URLHelper, ModelUtils) {\n    return Backbone.Model.extend({\n        idAttribute: \"name\",\n        urlRoot: URLHelper.substitute(\"__api__/policies\"),\n\n        defaults () {\n            return {\n                name: null,\n                description: \"\",\n                resources: [],\n                actionValues: {}\n            };\n        },\n\n        validate (attrs) {\n            if (attrs.name.trim() === \"\") {\n                return \"errorNoName\";\n            }\n\n            // entities that are stored in LDAP can't start with '#'. http://www.jguru.com/faq/view.jsp?EID=113588\n            if (attrs.name.indexOf(\"#\") === 0) {\n                return \"errorCantStartWithHash\";\n            }\n\n            if (attrs.resources.length === 0) {\n                return \"policyErrorNoResources\";\n            }\n        },\n\n        sync (method, model, options) {\n            options = options || {};\n            options.beforeSend = function (xhr) {\n                xhr.setRequestHeader(\"Accept-API-Version\", \"protocol=1.0,resource=2.0\");\n            };\n            options.error = ModelUtils.errorHandler;\n\n            if (model.id === null) {\n                method = \"create\";\n                options.url = `${this.urlRoot()}/?_action=create`;\n            }\n\n            return Backbone.Model.prototype.sync.call(this, method, model, options);\n        }\n    });\n});\n"]}