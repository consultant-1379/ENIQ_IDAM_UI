{"version":3,"sources":["../../../../../../../XUI/org/forgerock/commons/ui/user-1/delegates/KBADelegate.js"],"names":["define","$","_","AbstractDelegate","Configuration","Constants","KBADelegate","context","SELF_SERVICE_CONTEXT","getInfo","serviceCall","saveInfo","user","loggedUser","id","JSON","stringify","map","value","key","then","updatedUser","save"],"mappings":";;AAAA;;;;;;;;;;;;;;;AAeA;AACCA,OAAO,CACJ,QADI,EAEJ,QAFI,EAGJ,uDAHI,EAIJ,oDAJI,EAKJ,gDALI,CAAP,EAME,UAAUC,CAAV,EAAaC,CAAb,EAAgBC,gBAAhB,EAAkCC,aAAlC,EAAiDC,SAAjD,EAA4D;;AAE3D,QAAIC,cAAc,IAAIH,gBAAJ,CAAqB,MAAME,UAAUE,OAAhB,GAA0B,GAA1B,GAAgCF,UAAUG,oBAA/D,CAAlB;;AAEAF,gBAAYG,OAAZ,GAAsB,YAAY;AAC9B,eAAO,KAAKC,WAAL,CAAiB,EAAE,OAAQ,KAAV,EAAjB,CAAP;AACH,KAFD;;AAIAJ,gBAAYK,QAAZ,GAAuB,UAAUC,IAAV,EAAgB;AACnC,eAAO,KAAKF,WAAL,CAAiB;AACpB,oBAAQ,OADY;AAEpB,mBAAO,UAAUN,cAAcS,UAAd,CAAyBC,EAFtB;AAGpB,oBAAQC,KAAKC,SAAL,CACJd,EAAEU,IAAF,EACEK,GADF,CACM,UAAUC,KAAV,EAAiBC,GAAjB,EAAsB;AACvB,uBAAO;AACH,iCAAa,SADV;AAEH,6BAAS,MAAMA,GAFZ;AAGH;AACA;AACA,6BAASD;AALN,iBAAP;AAOH,aATF,CADI;AAHY,SAAjB,EAeJE,IAfI,CAeC,UAAUC,WAAV,EAAuB;AAC3B,mBAAOjB,cAAcS,UAAd,CAAyBS,IAAzB,CAA8BD,WAA9B,EAA2C,EAAC,UAAU,IAAX,EAA3C,CAAP;AACH,SAjBM,CAAP;AAkBH,KAnBD;;AAqBA,WAAOf,WAAP;AACH,CApCA","file":"KBADelegate.js","sourcesContent":["/**\r\n * The contents of this file are subject to the terms of the Common Development and\r\n * Distribution License (the License). You may not use this file except in compliance with the\r\n * License.\r\n *\r\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\r\n * specific language governing permission and limitations under the License.\r\n *\r\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\r\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\r\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\r\n * information: \"Portions copyright [year] [name of copyright owner]\".\r\n *\r\n * Copyright 2015-2016 ForgeRock AS.\r\n */\r\n/* eslint-disable */\r\n define([\r\n    \"jquery\",\r\n    \"lodash\",\r\n    \"org/forgerock/commons/ui/common/main/AbstractDelegate\",\r\n    \"org/forgerock/commons/ui/common/main/Configuration\",\r\n    \"org/forgerock/commons/ui/common/util/Constants\"\r\n], function ($, _, AbstractDelegate, Configuration, Constants) {\r\n\r\n    var KBADelegate = new AbstractDelegate(\"/\" + Constants.context + \"/\" + Constants.SELF_SERVICE_CONTEXT);\r\n\r\n    KBADelegate.getInfo = function () {\r\n        return this.serviceCall({ \"url\" : \"kba\" });\r\n    };\r\n\r\n    KBADelegate.saveInfo = function (user) {\r\n        return this.serviceCall({\r\n            \"type\": \"PATCH\",\r\n            \"url\": \"user/\" + Configuration.loggedUser.id,\r\n            \"data\": JSON.stringify(\r\n                _(user)\r\n                 .map(function (value, key) {\r\n                     return {\r\n                         \"operation\": \"replace\",\r\n                         \"field\": \"/\" + key,\r\n                         // replace the whole value, rather than just the parts that have changed,\r\n                         // since there is no consistent way to target items in a set across the stack\r\n                         \"value\": value\r\n                     };\r\n                 })\r\n            )\r\n        }).then(function (updatedUser) {\r\n            return Configuration.loggedUser.save(updatedUser, {\"silent\": true});\r\n        });\r\n    };\r\n\r\n    return KBADelegate;\r\n});"]}