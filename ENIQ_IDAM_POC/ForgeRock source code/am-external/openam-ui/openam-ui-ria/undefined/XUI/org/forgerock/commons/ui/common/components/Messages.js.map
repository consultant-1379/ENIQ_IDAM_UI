{"version":3,"sources":["../../../../../../../XUI/org/forgerock/commons/ui/common/components/Messages.js"],"names":["define","$","_","Backbone","AbstractConfigurationAware","obj","Messages","TYPE_SUCCESS","TYPE_INFO","TYPE_WARNING","TYPE_DANGER","View","extend","list","el","events","delay","timer","displayMessageFromConfig","event","_this","messages","key","addMessage","message","t","configuration","msg","type","i","response","responseJSON","length","console","log","escape","info","push","showMessage","nextMessage","shift","removeAndNext","window","clearTimeout","$el","find","fadeOut","remove","alertClass","alertIcon","hasNavigation","addClass","removeClass","append","fadeIn","setTimeout","hideMessages"],"mappings":"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","file":"Messages.js","sourcesContent":["/**\r\n * The contents of this file are subject to the terms of the Common Development and\r\n * Distribution License (the License). You may not use this file except in compliance with the\r\n * License.\r\n *\r\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\r\n * specific language governing permission and limitations under the License.\r\n *\r\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\r\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\r\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\r\n * information: \"Portions copyright [year] [name of copyright owner]\".\r\n *\r\n * Copyright 2011-2016 ForgeRock AS.\r\n */\r\n/* eslint-disable */\r\n define([\r\n    \"jquery\",\r\n    \"underscore\",\r\n    \"backbone\",\r\n    \"org/forgerock/commons/ui/common/main/AbstractConfigurationAware\"\r\n], function($, _, Backbone, AbstractConfigurationAware) {\r\n    var obj = new AbstractConfigurationAware(), Messages;\r\n\r\n    obj.TYPE_SUCCESS =  \"success\";\r\n    obj.TYPE_INFO =     \"info\";\r\n    obj.TYPE_WARNING =  \"warning\";\r\n    obj.TYPE_DANGER =   \"error\";\r\n\r\n    Messages = Backbone.View.extend({\r\n\r\n        list: [],\r\n        el: \"#messages\",\r\n        events: {\r\n            \"click div\": \"removeAndNext\"\r\n        },\r\n        delay: 2500,\r\n        timer: null,\r\n\r\n        displayMessageFromConfig: function(event) {\r\n            var _this = obj.messages;\r\n            if (typeof event === \"object\") {\r\n                if (typeof event.key === \"string\") {\r\n                    _this.addMessage({\r\n                        message: $.t(obj.configuration.messages[event.key].msg, event),\r\n                        type: obj.configuration.messages[event.key].type\r\n                    });\r\n                }\r\n            } else if (typeof event === \"string\") {\r\n                _this.addMessage({\r\n                    message: $.t(obj.configuration.messages[event].msg),\r\n                    type: obj.configuration.messages[event].type\r\n                });\r\n            }\r\n        },\r\n        /**\r\n         * @param {Object} msg contains the message object\r\n         * @param {string} msg.type - The type of mesage to be displayed. TYPE_SUCCESS, TYPE_INFO, TYPE_WARNING\r\n         * or TYPE_DANGER\r\n         * @param {string} [msg.messages] - The message to be displayed.\r\n         * @param {Object} [msg.response] - The responce from a rest call will be parsed to extract the message\r\n         * @param {boolean} [msg.escape] - If set to true the displayed message will be escaped. This is useful when\r\n         * the message could contain unsafe strings.\r\n         */\r\n        addMessage: function(msg) {\r\n            var i, _this = obj.messages;\r\n            if(!msg.message && msg.response && typeof msg.response.responseJSON === \"object\"\r\n                && typeof msg.response.responseJSON.message === \"string\"){\r\n                msg.message = msg.response.responseJSON.message;\r\n            }\r\n            for(i = 0; i < _this.list.length; i++) {\r\n                if(_this.list[i].message === msg.message) {\r\n                    console.log(\"duplicated message\");\r\n                    return;\r\n                }\r\n            }\r\n            if (msg.escape === true) {\r\n                msg.message = _.escape(msg.message);\r\n            }\r\n            console.info(msg.type + \":\", msg.message, msg);\r\n            _this.list.push(msg);\r\n            if (_this.list.length <= 1) {\r\n                _this.showMessage(msg);\r\n            }\r\n        },\r\n\r\n        nextMessage: function() {\r\n            var _this = obj.messages;\r\n            _this.list.shift();\r\n            if (_this.list.length > 0) {\r\n                _this.showMessage();\r\n            }\r\n        },\r\n\r\n        removeAndNext: function() {\r\n            var _this = obj.messages;\r\n            window.clearTimeout(obj.messages.timer);\r\n            _this.$el.find(\"div\").fadeOut(300, function(){\r\n                $(this).remove();\r\n                _this.nextMessage();\r\n            });\r\n        },\r\n\r\n        showMessage: function() {\r\n            var _this = this,\r\n                alertClass = \"alert-info\",\r\n                alertIcon = \"alert-message-icon\",\r\n                delay = _this.delay + (this.list[0].message.length * 20);\r\n\r\n            switch (this.list[0].type ){\r\n                case obj.TYPE_DANGER:\r\n                    alertClass = \"alert-danger\";\r\n                    break;\r\n                case obj.TYPE_SUCCESS:\r\n                    alertClass = \"alert-success\";\r\n                    alertIcon = \"fa-check-circle-o\";\r\n                    break;\r\n                case obj.TYPE_WARNING:\r\n                    alertClass = \"alert-warning\";\r\n                    break;\r\n                case obj.TYPE_INFO:\r\n                    alertClass = \"alert-info\";\r\n                    break;\r\n                default:\r\n                    alertClass = \"alert-info\";\r\n                    break;\r\n            }\r\n\r\n            if (this.hasNavigation()) {\r\n                _this.$el.addClass('logged-user');\r\n            } else {\r\n                _this.$el.removeClass('logged-user');\r\n            }\r\n\r\n            this.$el.append(\"<div role='alert' class='alert-system alert-message alert \" + alertClass\r\n                + \"'><i class='fa \" + alertIcon + \"'></i><span class='message'>\" + this.list[0].message\r\n                + \"</span></div>\");\r\n            this.$el.find(\"div:last\").fadeIn(300, function () {\r\n                _this.timer = window.setTimeout(_this.removeAndNext, delay);\r\n            });\r\n        },\r\n\r\n        hideMessages: function() {\r\n            var _this = obj.messages;\r\n            if (_this.list.length > 1) {\r\n                _this.list = [_this.list[1]];\r\n            }\r\n        },\r\n\r\n        hasNavigation: function() {\r\n            return $('#mainNavHolder').length > 0;\r\n        }\r\n\r\n    });\r\n\r\n    obj.messages = new Messages();\r\n\r\n    obj.addMessage = function(msg){\r\n        obj.messages.addMessage(msg);\r\n    };\r\n\r\n    return obj;\r\n});"]}