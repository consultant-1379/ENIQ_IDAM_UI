{"version":3,"sources":["../../../../../../../XUI/org/forgerock/commons/ui/common/util/UIUtils.js"],"names":["define","$","_","require","Handlebars","i18next","ThemeManager","AbstractConfigurationAware","ModuleLoader","Router","obj","templates","fetchTemplate","url","ajax","type","toUrl","dataType","fetchAndSaveTemplate","urlToFetch","urlToSave","done","template","fetchAndCompileTemplate","data","then","compile","registerPartial","name","renderTemplate","templateUrl","el","callback","mode","validation","compileTemplate","validateAndRender","append","html","fillTemplateWithData","compileCallback","getTheme","theme","templateUrlWithPath","path","templateSavedPath","fallBackToDefaultPath","console","log","Deferred","resolve","preloadTemplates","urls","promises","each","urlWithPath","push","when","apply","preloadInitialTemplates","configuration","templateUrls","preloadPartial","replace","partials","preloadInitialPartials","partialUrls","fn","emptySelect","tagName","options","length","loadSelect","optionsDataArray","i","option","selectElement","Option","value","key","event","special","delayedkeyup","setup","bind","handler","teardown","unbind","self","args","arguments","doTimeout","handle","registerHelper","map","elementName","selectedKey","selectedValue","multiple","height","result","prePart","postPart","content","isSelected","entityName","isString","t","SafeString","selected","find","toString","attr","additionalParams","entityKey","JSON","parse","countValue","params","count","hash","val","val2","inverse","ret","idx","sortedMap","chain","pairs","sortBy","arr","encodeURIComponent","images","encodeURI","array","buffer","item","k","j","index","first","last","string","newString","toUpperCase","slice","spaces","stringify","routeKey","concat","getLink","routes","toArray","arg","context","partial","error","loadSelectOptions","empty","undefined","jqConfirm","message","confirmCallback","confirmDialog","load","BootstrapDialog","btnType","show","title","id","buttons","label","action","dialog","close","cssClass","responseMessageMatch","responseMessage","indexOf","mixin","collection","property","values","filter","contains","reject","regexp","test"],"mappings":";;;;AAAA;;;;;;;;;;;;;;;AAeA;AACCA,OAAO,CACJ,QADI,EAEJ,YAFI,EAGJ,SAHI,EAIJ,YAJI,EAKJ,SALI,EAMJ,cANI,EAOJ,iEAPI,EAQJ,mDARI,EASJ,6CATI,CAAP,EAUE,UAAUC,CAAV,EAAaC,CAAb,EAAgBC,OAAhB,EAAyBC,UAAzB,EAAqCC,OAArC,EAA8CC,YAA9C,EAA4DC,0BAA5D,EAAwFC,YAAxF,EAAsGC,MAAtG,EAA8G;;AAE7G;;;AAGA,QAAIC,MAAM,IAAIH,0BAAJ,EAAV;;AAEAG,QAAIC,SAAJ,GAAgB,EAAhB;;AAEA,aAASC,aAAT,CAAuBC,GAAvB,EAA4B;AACxB,eAAOZ,EAAEa,IAAF,CAAO,EAAEC,MAAM,KAAR,EAAeF,KAAKV,QAAQa,KAAR,CAAcH,GAAd,CAApB,EAAwCI,UAAU,MAAlD,EAAP,CAAP;AACH;;AAED,aAASC,oBAAT,CAA8BC,UAA9B,EAA0CC,SAA1C,EAAqD;AACjD,eAAOR,cAAcO,UAAd,EAA0BE,IAA1B,CAA+B,UAAUC,QAAV,EAAoB;AACtDZ,gBAAIC,SAAJ,CAAcS,SAAd,IAA2BE,QAA3B;AACH,SAFM,CAAP;AAGH;;AAED,aAASC,uBAAT,CAAiCJ,UAAjC,EAA6CC,SAA7C,EAAwDI,IAAxD,EAA8D;AAC1D,eAAOZ,cAAcO,UAAd,EAA0BM,IAA1B,CAA+B,UAAUH,QAAV,EAAoB;AACtD,gBAAIE,SAAS,SAAT,IAAsBA,SAAS,IAAnC,EAAyC;AACrCd,oBAAIC,SAAJ,CAAcS,SAAd,IAA2BE,QAA3B;AACAA,2BAAWlB,WAAWsB,OAAX,CAAmBJ,QAAnB,EAA6BE,IAA7B,CAAX;AACH;AACD,mBAAOF,QAAP;AACH,SANM,CAAP;AAOH;;AAED,aAASK,eAAT,CAAyBC,IAAzB,EAA+Bf,GAA/B,EAAoC;AAChC,eAAOD,cAAcC,GAAd,EAAmBY,IAAnB,CAAwB,UAAUD,IAAV,EAAgB;AAC3CpB,uBAAWuB,eAAX,CAA2BC,IAA3B,EAAiCxB,WAAWsB,OAAX,CAAmBF,IAAnB,CAAjC;AACH,SAFM,CAAP;AAGH;;AAED;;;;;;;;;;AAUAd,QAAImB,cAAJ,GAAqB,UAAUC,WAAV,EAAuBC,EAAvB,EAA2BP,IAA3B,EAAiCQ,QAAjC,EAA2CC,IAA3C,EAAiDC,UAAjD,EAA6D;AAC9E,eAAOxB,IAAIyB,eAAJ,CAAoBL,WAApB,EAAiCN,IAAjC,EAAuCC,IAAvC,CAA4C,SAASW,iBAAT,CAA2Bd,QAA3B,EAAqC;AACpF,gBAAIY,cAAc,CAACA,YAAnB,EAAiC;AAC7B,uBAAO,KAAP;AACH;;AAED,gBAAID,SAAS,QAAb,EAAuB;AACnBF,mBAAGM,MAAH,CAAUf,QAAV;AACH,aAFD,MAEO;AACHS,mBAAGO,IAAH,CAAQhB,QAAR;AACH;;AAED,gBAAIU,QAAJ,EAAc;AACVA;AACH;AACJ,SAdM,CAAP;AAeH,KAhBD;;AAkBC;;;;AAIDtB,QAAI6B,oBAAJ,GAA2B,UAAUT,WAAV,EAAuBN,IAAvB,EAA6BgB,eAA7B,EAA8C;AACrE,eAAO9B,IAAIyB,eAAJ,CAAoBL,WAApB,EAAiCN,IAAjC,EAAuCC,IAAvC,CAA4Ce,eAA5C,CAAP;AACH,KAFD;;AAIA;;;;;;AAMA9B,QAAIyB,eAAJ,GAAsB,UAAUL,WAAV,EAAuBN,IAAvB,EAA6B;AAC/C,YAAIM,WAAJ,EAAiB;AACb,mBAAOxB,aAAamC,QAAb,GAAwBhB,IAAxB,CAA6B,UAAUiB,KAAV,EAAiB;AACjD,oBAAIC,sBAAsBD,MAAME,IAAN,GAAad,WAAvC;AAAA,oBACIe,oBAAoBH,MAAME,IAAN,GAAaD,mBAAb,GAAmCb,WAD3D;;AAGA,oBAAIpB,IAAIC,SAAJ,CAAckC,iBAAd,CAAJ,EAAsC;AAClC,2BAAOzC,WAAWsB,OAAX,CAAmBhB,IAAIC,SAAJ,CAAckC,iBAAd,CAAnB,EAAqDrB,IAArD,CAAP;AACH,iBAFD,MAEO,IAAIkB,MAAME,IAAV,EAAgB;AACnB,2BAAOrB,wBAAwBoB,mBAAxB,EAA6CA,mBAA7C,EAAkEnB,IAAlE,EACFC,IADE,CACG,IADH,EACS,SAASqB,qBAAT,GAAiC;AACzCC,gCAAQC,GAAR,CAAYL,sBAAsB,yBAAtB,GAAkDb,WAA9D;AACA,+BAAOP,wBAAwBO,WAAxB,EAAqCa,mBAArC,EAA0DnB,IAA1D,CAAP;AACH,qBAJE,CAAP;AAKH,iBANM,MAMA;AACH,2BAAOD,wBAAwBO,WAAxB,EAAqCA,WAArC,EAAkDN,IAAlD,CAAP;AACH;AACJ,aAfM,CAAP;AAgBH,SAjBD,MAiBO;AACH,mBAAOvB,EAAEgD,QAAF,GAAaC,OAAb,CAAqB,EAArB,CAAP;AACH;AACJ,KArBD;;AAuBA;;;;AAIAxC,QAAIyC,gBAAJ,GAAuB,UAAUC,IAAV,EAAgB;AACnC,YAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC1BA,mBAAO,CAACA,IAAD,CAAP;AACH;;AAED,eAAO9C,aAAamC,QAAb,GAAwBhB,IAAxB,CAA6B,UAAUiB,KAAV,EAAiB;AACjD,gBAAIW,WAAW,EAAf;;AAEA,gBAAIX,MAAME,IAAV,EAAgB;AACZ1C,kBAAEoD,IAAF,CAAOF,IAAP,EAAa,UAAUtB,WAAV,EAAuB;AAChC,wBAAIyB,cAAcb,MAAME,IAAN,GAAad,WAA/B;AACAuB,6BAASG,IAAT,CACItC,qBAAqBqC,WAArB,EAAkCA,WAAlC,EAA+C9B,IAA/C,CAAoD,IAApD,EAA0D,SAASqB,qBAAT,GAAiC;AACvFC,gCAAQC,GAAR,CAAYO,cAAc,yBAAd,GAA0CzB,WAAtD;AACAuB,iCAASG,IAAT,CAActC,qBAAqBY,WAArB,EAAkCyB,WAAlC,CAAd;AACH,qBAHD,CADJ;AAKH,iBAPD;AAQH,aATD,MASO;AACHrD,kBAAEoD,IAAF,CAAOF,IAAP,EAAa,UAAUtB,WAAV,EAAuB;AAChCuB,6BAASG,IAAT,CAActC,qBAAqBY,WAArB,EAAkCA,WAAlC,CAAd;AACH,iBAFD;AAGH;;AAED,mBAAO7B,EAAEwD,IAAF,CAAOC,KAAP,CAAazD,CAAb,EAAgBoD,QAAhB,CAAP;AACH,SAnBM,CAAP;AAoBH,KAzBD;;AA2BA;;;AAGA3C,QAAIiD,uBAAJ,GAA8B,YAAW;AACrCjD,YAAIyC,gBAAJ,CAAqBzC,IAAIkD,aAAJ,CAAkBC,YAAvC;AACH,KAFD;;AAIA;;;;;;;;;;AAUAnD,QAAIoD,cAAJ,GAAqB,UAAUjD,GAAV,EAAe;AAChC,YAAIe,OAAOf,IAAIkD,OAAJ,CAAY,0BAAZ,EAAwC,EAAxC,CAAX;;AAEA,eAAOzD,aAAamC,QAAb,GAAwBhB,IAAxB,CAA6B,UAAUiB,KAAV,EAAiB;AACjD,gBAAItC,WAAW4D,QAAX,CAAoBpC,IAApB,CAAJ,EAA+B;AAC3B;AACH,aAFD,MAEO,IAAIc,MAAME,IAAV,EAAgB;AACnB,uBAAOjB,gBAAgBC,IAAhB,EAAsBc,MAAME,IAAN,GAAa/B,GAAnC,EACFY,IADE,CACG,IADH,EACS,SAASqB,qBAAT,GAAiC;AACzCC,4BAAQC,GAAR,CAAYN,MAAME,IAAN,GAAa/B,GAAb,GAAmB,yBAAnB,GAA+CA,GAA3D;AACA,2BAAOc,gBAAgBC,IAAhB,EAAsBf,GAAtB,CAAP;AACH,iBAJE,CAAP;AAKH,aANM,MAMA;AACH,uBAAOc,gBAAgBC,IAAhB,EAAsBf,GAAtB,CAAP;AACH;AACJ,SAZM,CAAP;AAaH,KAhBD;;AAkBA;;;AAGAH,QAAIuD,sBAAJ,GAA6B,YAAW;AACpC/D,UAAEoD,IAAF,CAAO5C,IAAIkD,aAAJ,CAAkBM,WAAzB,EAAsC,UAASrD,GAAT,EAAc;AAChDH,gBAAIoD,cAAJ,CAAmBjD,GAAnB;AACH,SAFD;AAGH,KAJD;;AAMAZ,MAAEkE,EAAF,CAAKC,WAAL,GAAmB,YAAW;AAC1B,eAAO,KAAKd,IAAL,CAAU,YAAW;AACxB,gBAAI,KAAKe,OAAL,KAAiB,QAArB,EAA+B;AAC3B,qBAAKC,OAAL,CAAaC,MAAb,GAAsB,CAAtB;AACH;AACJ,SAJM,CAAP;AAKH,KAND;;AAQAtE,MAAEkE,EAAF,CAAKK,UAAL,GAAkB,UAASC,gBAAT,EAA2B;AACzC,eAAO,KAAKL,WAAL,GAAmBd,IAAnB,CAAwB,YAAW;AACtC,gBAAI,KAAKe,OAAL,KAAiB,QAArB,EAA+B;AAC3B,oBAAIK,CAAJ;AAAA,oBAAOC,MAAP;AAAA,oBAAeC,gBAAgB,IAA/B;AACA,qBAAIF,IAAI,CAAR,EAAWA,IAAID,iBAAiBF,MAAhC,EAAwCG,GAAxC,EAA4C;AACxCC,6BAAS,IAAIE,MAAJ,CAAWJ,iBAAiBC,CAAjB,EAAoBI,KAA/B,EAAsCL,iBAAiBC,CAAjB,EAAoBK,GAA1D,CAAT;AACAH,kCAAcN,OAAd,CAAsBM,cAAcN,OAAd,CAAsBC,MAA5C,IAAsDI,MAAtD;AACH;AACJ;AACJ,SARM,CAAP;AASH,KAVD;;AAYA1E,MAAE+E,KAAF,CAAQC,OAAR,CAAgBC,YAAhB,GAA+B;AAC3BC,eAAO,iBAAW;AACdlF,cAAE,IAAF,EAAQmF,IAAR,CAAa,OAAb,EAAsBnF,EAAE+E,KAAF,CAAQC,OAAR,CAAgBC,YAAhB,CAA6BG,OAAnD;AACH,SAH0B;;AAK3BC,kBAAU,oBAAW;AACjBrF,cAAE,IAAF,EAAQsF,MAAR,CAAe,OAAf,EAAwBtF,EAAE+E,KAAF,CAAQC,OAAR,CAAgBC,YAAhB,CAA6BG,OAArD;AACH,SAP0B;;AAS3BA,iBAAS,iBAAUL,KAAV,EAAkB;AACvB,gBAAIQ,OAAO,IAAX;AAAA,gBAAiBC,OAAOC,SAAxB;;AAEAV,kBAAMjE,IAAN,GAAa,cAAb;;AAEAd,cAAE0F,SAAF,CAAY,cAAZ,EAA4B,GAA5B,EAAiC,YAAW;AACxC1F,kBAAE+E,KAAF,CAAQY,MAAR,CAAelC,KAAf,CAAqB8B,IAArB,EAA2BC,IAA3B;AACH,aAFD;AAGH;AAjB0B,KAA/B;;AAoBA;AACArF,eAAWyF,cAAX,CAA0B,SAA1B,EAAqC,UAASC,GAAT,EAAcC,WAAd,EAA2BC,WAA3B,EAAwCC,aAAxC,EAAuDC,QAAvD,EAAiEC,MAAjE,EAAyE;AAC1G,YAAIC,MAAJ;AAAA,YAAYC,OAAZ;AAAA,YAAqBC,QAArB;AAAA,YAA+BC,UAAU,EAAzC;AAAA,YAA6CC,UAA7C;AAAA,YAAyDC,UAAzD;;AAEAJ,kBAAU,SAAV;;AAEA,YAAIN,eAAe7F,EAAEwG,QAAF,CAAWX,WAAX,CAAnB,EAA4C;AACxCM,uBAAW,YAAYN,WAAZ,GAA0B,GAArC;AACH;;AAED,YAAGG,QAAH,EAAa;AACTG,uBAAW,sBAAX;AACH;;AAED,YAAGF,MAAH,EAAW;AACPE,uBAAW,qBAAoBF,MAApB,GAA4B,KAAvC;AACH;;AAEDE,mBAAW,GAAX;;AAEAC,mBAAW,YAAX;;AAEA,aAAKG,UAAL,IAAmBX,GAAnB,EAAwB;AACpBU,yBAAa,KAAb;AACA,gBAAIP,iBAAiB/F,EAAEwG,QAAF,CAAWT,aAAX,CAArB,EAAgD;AAC5C,oBAAIA,kBAAkBH,IAAIW,UAAJ,CAAtB,EAAuC;AACnCD,iCAAa,IAAb;AACH;AACJ,aAJD,MAIO,IAAIR,eAAeA,gBAAgBS,UAAnC,EAA+C;AAClDD,6BAAa,IAAb;AACH;;AAED,gBAAIA,UAAJ,EAAgB;AACZD,2BAAW,oBAAoBE,UAApB,GAAiC,oBAAjC,GAAwDxG,EAAE0G,CAAF,CAAIb,IAAIW,UAAJ,CAAJ,CAAxD,GAA+E,WAA1F;AACH,aAFD,MAEO;AACHF,2BAAW,oBAAoBE,UAApB,GAAiC,IAAjC,GAAwCxG,EAAE0G,CAAF,CAAIb,IAAIW,UAAJ,CAAJ,CAAxC,GAA+D,WAA1E;AACH;AACJ;;AAEDL,iBAASC,UAAUE,OAAV,GAAoBD,QAA7B;AACA,eAAO,IAAIlG,WAAWwG,UAAf,CAA0BR,MAA1B,CAAP;AACH,KAxCD;;AA0CA;;;;;;;;;;;;;;;AAeAhG,eAAWyF,cAAX,CAA0B,cAA1B,EAA0C,UAASf,KAAT,EAAgBR,OAAhB,EAAwB;AAC9D,YAAIuC,WAAW5G,EAAE,YAAF,EAAgBqC,IAAhB,CAAqBgC,QAAQH,EAAR,CAAW,IAAX,CAArB,CAAf;AACA,YAAI,OAAOW,KAAP,KAAiB,WAAjB,IAAgCA,UAAU,IAA9C,EAAoD;AAChD+B,qBAASC,IAAT,CAAc,cAAchC,MAAMiC,QAAN,GAAiBhD,OAAjB,CAAyB,GAAzB,EAA8B,KAA9B,CAAd,GAAqD,KAAnE,EAA0EiD,IAA1E,CAA+E,EAAC,YAAW,UAAZ,EAA/E;AACH;AACD,eAAOH,SAASvE,IAAT,EAAP;AACH,KAND;;AAQAlC,eAAWyF,cAAX,CAA0B,QAA1B,EAAoC,UAASC,GAAT,EAAcC,WAAd,EAA2BC,WAA3B,EAAwCC,aAAxC,EAAuDgB,gBAAvD,EAAyE;AACzG,YAAIb,MAAJ;AAAA,YAAYC,OAAZ;AAAA,YAAqBC,QAArB;AAAA,YAA+BC,UAAU,EAAzC;AAAA,YAA6CC,UAA7C;AAAA,YAAyDC,UAAzD;AAAA,YAAqES,SAArE;;AAEA,YAAIpB,OAAO5F,EAAEwG,QAAF,CAAWZ,GAAX,CAAX,EAA4B;AACxBA,kBAAMqB,KAAKC,KAAL,CAAWtB,GAAX,CAAN;AACH;;AAED,YAAIC,eAAe7F,EAAEwG,QAAF,CAAWX,WAAX,CAAnB,EAA4C;AACxCM,sBAAU,mBAAmBN,WAAnB,GAAiC,IAAjC,GAAwCkB,gBAAxC,GAA2D,GAArE;AACH,SAFD,MAEM;AACFZ,sBAAU,UAAV;AACH;;AAEDC,mBAAW,YAAX;;AAEA,aAAKG,UAAL,IAAmBX,GAAnB,EAAwB;AACpBU,yBAAa,KAAb;AACA,gBAAIP,iBAAiB/F,EAAEwG,QAAF,CAAWT,aAAX,CAAjB,IAA8CA,kBAAkB,EAApE,EAAwE;AACpE,oBAAIA,kBAAkBH,IAAIW,UAAJ,CAAtB,EAAuC;AACnCD,iCAAa,IAAb;AACH;AACJ,aAJD,MAIO,IAAIR,eAAeA,gBAAgB,EAA/B,IAAqCA,gBAAgBS,UAAzD,EAAqE;AACxED,6BAAa,IAAb;AACH;;AAED,gBAAIC,eAAe,QAAnB,EAA6B;AACzBS,4BAAY,EAAZ;AACH,aAFD,MAEO;AACHA,4BAAYT,UAAZ;AACH;;AAED,gBAAID,UAAJ,EAAgB;AACZD,2BAAW,oBAAoBW,SAApB,GAAgC,oBAAhC,GAAuDjH,EAAE0G,CAAF,CAAIb,IAAIW,UAAJ,CAAJ,CAAvD,GAA8E,WAAzF;AACH,aAFD,MAEO;AACHF,2BAAW,oBAAoBW,SAApB,GAAgC,IAAhC,GAAuCjH,EAAE0G,CAAF,CAAIb,IAAIW,UAAJ,CAAJ,CAAvC,GAA8D,WAAzE;AACH;AACJ;;AAEDL,iBAASC,UAAUE,OAAV,GAAoBD,QAA7B;AACA,eAAO,IAAIlG,WAAWwG,UAAf,CAA0BR,MAA1B,CAAP;AACH,KAxCD;;AA0CAhG,eAAWyF,cAAX,CAA0B,GAA1B,EAA+B,UAASwB,UAAT,EAAqB/C,OAArB,EAA8B;AACzD,YAAIgD,MAAJ,EAAYlB,MAAZ;AACAkB,iBAAS,EAAEC,OAAOF,UAAT,EAAT;AACAjB,iBAAS/F,QAAQsG,CAAR,CAAUrC,QAAQkD,IAAR,CAAazC,GAAvB,EAA4BuC,MAA5B,CAAT;AACA,eAAO,IAAIlH,WAAWwG,UAAf,CAA0BR,MAA1B,CAAP;AACH,KALD;;AAQA;;;;;;;;;;;;AAYAhG,eAAWyF,cAAX,CAA0B,QAA1B,EAAoC,UAAS4B,GAAT,EAAcC,IAAd,EAAoBpD,OAApB,EAA6B;AAC7D,YAAImD,QAAQC,IAAZ,EAAkB;AACd,mBAAOpD,QAAQH,EAAR,CAAW,IAAX,CAAP;AACH,SAFD,MAEO;AACH,mBAAOG,QAAQqD,OAAR,CAAgB,IAAhB,CAAP;AACH;AACJ,KAND;;AAQAvH,eAAWyF,cAAX,CAA0B,UAA1B,EAAsC,UAASC,GAAT,EAAclE,IAAd,EAAoB;AACtD,YAAIgG,MAAM,mCAAiChG,IAAjC,GAAsC,QAAhD;AAAA,YAA0DiG,GAA1D;AAAA,YACIC,YAAY5H,EAAE6H,KAAF,CAAQjC,GAAR,EACKkC,KADL,GAEKC,MAFL,CAEY,UAAUC,GAAV,EAAe;AAAE,mBAAOA,IAAI,CAAJ,CAAP;AAAgB,SAF7C,EAGKpD,KAHL,EADhB;;AAMA,aAAI+C,MAAI,CAAR,EAAUA,MAAIC,UAAUvD,MAAxB,EAA+BsD,KAA/B,EAAsC;AAClCD,mBAAO,sCAAqChG,IAArC,GAA2C,WAA3C,GAAwDkG,UAAUD,GAAV,EAAe,CAAf,CAAxD,GAA2E,QAA3E,GAAqFjG,IAArF,GAA2F,GAA3F,GACDuG,mBAAmBL,UAAUD,GAAV,EAAe,CAAf,CAAnB,CADC,GACsC,gBADtC,GACwDjG,IADxD,GAC8D,GAD9D,GAEDuG,mBAAmBL,UAAUD,GAAV,EAAe,CAAf,CAAnB,CAFC,GAEsC,IAFtC,GAE6CC,UAAUD,GAAV,EAAe,CAAf,CAF7C,GAEiE,eAFxE;AAGH;;AAEDD,eAAO,aAAP;;AAEA,eAAO,IAAIxH,WAAWwG,UAAf,CAA0BgB,GAA1B,CAAP;AACH,KAhBD;;AAkBAxH,eAAWyF,cAAX,CAA0B,YAA1B,EAAwC,UAASuC,MAAT,EAAiB;AACrD,YAAIR,MAAM,EAAV;AAAA,YAAclD,CAAd;;AAEA,aAAIA,IAAI,CAAR,EAAWA,IAAI0D,OAAO7D,MAAtB,EAA8BG,GAA9B,EAAmC;AAC/BkD,mBAAO,4BACDS,UAAUD,OAAO1D,CAAP,CAAV,CADC,GACqB,qBADrB,GAED2D,UAAUD,OAAO1D,CAAP,CAAV,CAFC,GAEqB,MAF5B;AAGH;;AAED,eAAO,IAAItE,WAAWwG,UAAf,CAA0BgB,GAA1B,CAAP;AACH,KAVD;;AAYAxH,eAAWyF,cAAX,CAA0B,iBAA1B,EAA6C,UAASyC,KAAT,EAAgBnE,EAAhB,EAAoB;AAC7D,YAAIoE,SAAS,EAAb;AAAA,YACIC,IADJ;AAAA,YAEIC,IAAE,CAFN;AAAA,YAGI/D,IAAE,CAHN;AAAA,YAIIgE,IAAE,CAJN;;AAMA,aAAKhE,IAAI,CAAJ,EAAOgE,IAAIJ,MAAM/D,MAAtB,EAA8BG,IAAIgE,CAAlC,EAAqChE,GAArC,EAA0C;AACtC,gBAAI4D,MAAM5D,CAAN,CAAJ,EAAc;AACV8D,uBAAO,EAAP;AACAA,qBAAK1D,KAAL,GAAawD,MAAM5D,CAAN,CAAb;;AAEA;AACA8D,qBAAKG,KAAL,GAAaF,CAAb;;AAEAD,qBAAKI,KAAL,GAAcH,MAAM,CAApB;AACAD,qBAAKK,IAAL,GAAaJ,MAAMH,MAAM/D,MAAzB;;AAEA;AACAgE,0BAAUpE,GAAGA,EAAH,CAAMqE,IAAN,CAAV;;AAEAC;AACH;AACJ;;AAED;AACA,eAAOF,MAAP;AAEH,KA5BD;;AA8BAnI,eAAWyF,cAAX,CAA0B,kBAA1B,EAA8C,UAASiD,MAAT,EAAiB;AAC3D,YAAIC,YAAYD,OAAO/E,OAAP,CAAe,iBAAf,EAAkC,OAAlC,CAAhB;AACA,eAAO,IAAI3D,WAAWwG,UAAf,CAA0BmC,UAAU,CAAV,EAAaC,WAAb,KAA6BD,UAAUE,KAAV,CAAgB,CAAhB,CAAvD,CAAP;AACH,KAHD;;AAKA7I,eAAWyF,cAAX,CAA0B,WAA1B,EAAuC,UAASiD,MAAT,EAAiBI,MAAjB,EAAyB;AAC5DA,iBAASA,SAASA,MAAT,GAAkB,CAA3B;AACA,YAAIH,YAAY5B,KAAKgC,SAAL,CAAeL,MAAf,EAAuB,IAAvB,EAA6BI,MAA7B,CAAhB;AACA,eAAOH,SAAP;AACH,KAJD;;AAMA3I,eAAWyF,cAAX,CAA0B,UAA1B,EAAsC,UAAS2C,IAAT,EAAelE,OAAf,EAAwB;AAC1D,YAAG,QAAOkE,IAAP,yCAAOA,IAAP,OAAgB,QAAnB,EAA6B;AACzB,mBAAOlE,QAAQH,EAAR,CAAW,IAAX,CAAP;AACH,SAFD,MAEO;AACH,mBAAOG,QAAQqD,OAAR,CAAgB,IAAhB,CAAP;AACH;AACJ,KAND;;AAQA;;;;;;AAMAvH,eAAWyF,cAAX,CAA0B,OAA1B,EAAmC,UAASuD,QAAT,EAAmB;AAClD,YAAI3D,OAAO,GAAG4D,MAAH,CAAU3D,UAAU,CAAV,CAAV,CAAX;AACA;AACA,eAAO,MAAMjF,OAAO6I,OAAP,CAAe7I,OAAOmD,aAAP,CAAqB2F,MAArB,CAA4BH,QAA5B,CAAf,EAAsD3D,IAAtD,CAAb;AACH,KAJD;;AAMA;;;;AAIArF,eAAWyF,cAAX,CAA0B,SAA1B,EAAqC,UAAUuD,QAAV,EAAoB;AACrD,YAAIhD,SAAS,GAAb;AAAA,YACIX,OAAOvF,EAAEsJ,OAAF,CAAU9D,SAAV,EAAqBuD,KAArB,CAA2B,CAA3B,EAA8B,CAAC,CAA/B,CADX;AAEAxD,eAAOvF,EAAE4F,GAAF,CAAML,IAAN,EAAY,UAAUgE,GAAV,EAAe;AAC9B,mBAAOtB,mBAAmBsB,GAAnB,CAAP;AACH,SAFM,CAAP;;AAIArD,kBAAU3F,OAAO6I,OAAP,CAAe7I,OAAOmD,aAAP,CAAqB2F,MAArB,CAA4BH,QAA5B,CAAf,EAAsD3D,IAAtD,CAAV;;AAEA,eAAO,IAAIrF,WAAWwG,UAAf,CAA0BR,MAA1B,CAAP;AACH,KAVD;;AAYA;;;;;AAKAhG,eAAWyF,cAAX,CAA0B,SAA1B,EAAqC,UAASjE,IAAT,EAAe8H,OAAf,EAAwB;AACzD,YAAIC,UAAUvJ,WAAW4D,QAAX,CAAoBpC,IAApB,CAAd;;AAEA,YAAG,CAAC+H,OAAJ,EAAa;AACT5G,oBAAQ6G,KAAR,CAAc,4DAA4DhI,IAA5D,GAAmE,IAAjF;AACH,SAFD,MAEO;AACH,mBAAO,IAAIxB,WAAWwG,UAAf,CAA0B+C,QAAQD,OAAR,CAA1B,CAAP;AACH;AACJ,KARD;;AAUAhJ,QAAImJ,iBAAJ,GAAwB,UAASrI,IAAT,EAAeO,EAAf,EAAmB+H,KAAnB,EAA0B9H,QAA1B,EAAoC;AACxD,YAAI8H,UAAUC,SAAV,IAAuBD,UAAU,IAArC,EAA4C;AACxCtI,mBAAO,CAAC;AACJ,uBAAQ,EADJ;AAEJ,yBAAUvB,EAAE0G,CAAF,CAAI,0BAAJ;AAFN,aAAD,EAGJ0C,MAHI,CAGG7H,IAHH,CAAP;AAIH;;AAEDO,WAAGyC,UAAH,CAAchD,IAAd;;AAEA,YAAGQ,QAAH,EAAa;AACTA,qBAASR,IAAT;AACH;AACJ,KAbD;;AAeA;AACA;AACAd,QAAIsJ,SAAJ,GAAgB,UAASC,OAAT,EAAkBC,eAAlB,EAAmC;AAC/C,aAAKC,aAAL,CAAmBF,OAAnB,EAA4B,SAA5B,EAAuCC,eAAvC;AACH,KAFD;;AAIA;;;;;;;;;;;;;;;;AAgBAxJ,QAAIyJ,aAAJ,GAAoB,UAASF,OAAT,EAAkBlJ,IAAlB,EAAwBmJ,eAAxB,EAAwC;AACxD1J,qBAAa4J,IAAb,CAAkB,kBAAlB,EAAsC3I,IAAtC,CAA2C,UAAU4I,eAAV,EAA2B;AAClE,gBAAIC,UAAU,SAAQvJ,IAAtB;;AAEA,gBAAGA,SAAS,SAAZ,EAAuB;AACnBuJ,0BAAU,aAAV;AACH;;AAEDD,4BAAgBE,IAAhB,CAAqB;AACjBC,uBAAOvK,EAAE0G,CAAF,CAAI,qBAAJ,CADU;AAEjB5F,sBAAM,UAASA,IAFE;AAGjBkJ,yBAASA,OAHQ;AAIjBQ,oBAAI,sBAJa;AAKjBC,yBAAS,CACL;AACIC,2BAAO1K,EAAE0G,CAAF,CAAI,oBAAJ,CADX;AAEI8D,wBAAI,8BAFR;AAGIG,4BAAQ,gBAASC,MAAT,EAAgB;AACpBA,+BAAOC,KAAP;AACH;AALL,iBADK,EAQL;AACIH,2BAAO1K,EAAE0G,CAAF,CAAI,gBAAJ,CADX;AAEIoE,8BAAUT,OAFd;AAGIG,wBAAI,2BAHR;AAIIG,4BAAQ,gBAASC,MAAT,EAAiB;AACrB,4BAAGX,eAAH,EAAoB;AAChBA;AACH;AACDW,+BAAOC,KAAP;AACH;AATL,iBARK;AALQ,aAArB;AA0BH,SAjCD;AAkCH,KAnCD;;AAqCApK,QAAIsK,oBAAJ,GAA2B,UAASpB,KAAT,EAAgBd,MAAhB,EAAuB;AAC9C,YAAImC,kBAAkB9D,KAAKC,KAAL,CAAWwC,KAAX,EAAkBK,OAAxC;AACA,eAAOgB,gBAAgBC,OAAhB,CAAwBpC,MAAxB,IAAkC,CAAC,CAA1C;AACH,KAHD;;AAKA;;AAEA5I,MAAEiL,KAAF,CAAQ;;AAEJ;;;;;;;;;;;;;;;;;;;;;;;;AAwBA,wBAAgB,sBAASC,UAAT,EAAqBC,QAArB,EAA+BC,MAA/B,EAAuC;AACnD,mBAAOpL,EAAEqL,MAAF,CAASH,UAAT,EAAqB,UAAS5C,IAAT,EAAe;AACvC,uBAAOtI,EAAEsL,QAAF,CAAWF,MAAX,EAAmB9C,KAAK6C,QAAL,CAAnB,CAAP;AACH,aAFM,CAAP;AAGH,SA9BG;;AAgCJ;;;;;;;;;;;;;;AAcA,0BAAkB,wBAASD,UAAT,EAAqBC,QAArB,EAA+BC,MAA/B,EAAuC;AACrD,mBAAOpL,EAAEuL,MAAF,CAASL,UAAT,EAAqB,UAAS5C,IAAT,EAAe;AACvC,uBAAOtI,EAAEsL,QAAF,CAAWF,MAAX,EAAmB9C,KAAK6C,QAAL,CAAnB,CAAP;AACH,aAFM,CAAP;AAGH,SAlDG;;AAoDJ;;;;AAIA,iBAAS,eAASvC,MAAT,EAAgB;AACrB,gBAAI4C,SAAS,+EAAb;AACA,mBAAOA,OAAOC,IAAP,CAAY7C,MAAZ,CAAP;AACH;;AA3DG,KAAR;;AA+DA,WAAOpI,GAAP;AACH,CApnBA","file":"UIUtils.js","sourcesContent":["/**\r\n * The contents of this file are subject to the terms of the Common Development and\r\n * Distribution License (the License). You may not use this file except in compliance with the\r\n * License.\r\n *\r\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\r\n * specific language governing permission and limitations under the License.\r\n *\r\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\r\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\r\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\r\n * information: \"Portions copyright [year] [name of copyright owner]\".\r\n *\r\n * Copyright 2011-2016 ForgeRock AS.\r\n */\r\n/* eslint-disable */\r\n define([\r\n    \"jquery\",\r\n    \"underscore\",\r\n    \"require\",\r\n    \"handlebars\",\r\n    \"i18next\",\r\n    \"ThemeManager\",\r\n    \"org/forgerock/commons/ui/common/main/AbstractConfigurationAware\",\r\n    \"org/forgerock/commons/ui/common/util/ModuleLoader\",\r\n    \"org/forgerock/commons/ui/common/main/Router\"\r\n], function ($, _, require, Handlebars, i18next, ThemeManager, AbstractConfigurationAware, ModuleLoader, Router) {\r\n\r\n    /**\r\n     * @exports org/forgerock/commons/ui/common/util/UIUtils\r\n     */\r\n    var obj = new AbstractConfigurationAware();\r\n\r\n    obj.templates = {};\r\n\r\n    function fetchTemplate(url) {\r\n        return $.ajax({ type: \"GET\", url: require.toUrl(url), dataType: \"html\" });\r\n    }\r\n\r\n    function fetchAndSaveTemplate(urlToFetch, urlToSave) {\r\n        return fetchTemplate(urlToFetch).done(function (template) {\r\n            obj.templates[urlToSave] = template;\r\n        });\r\n    }\r\n\r\n    function fetchAndCompileTemplate(urlToFetch, urlToSave, data) {\r\n        return fetchTemplate(urlToFetch).then(function (template) {\r\n            if (data !== \"unknown\" && data !== null) {\r\n                obj.templates[urlToSave] = template;\r\n                template = Handlebars.compile(template)(data);\r\n            }\r\n            return template;\r\n        });\r\n    }\r\n\r\n    function registerPartial(name, url) {\r\n        return fetchTemplate(url).then(function (data) {\r\n            Handlebars.registerPartial(name, Handlebars.compile(data));\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Renders the template.\r\n     * @param {String} templateUrl - template url.\r\n     * @param {JQuery} el - element, in which the template should be rendered.\r\n     * @param {Object} data - template will be compiled with this data.\r\n     * @param {Function} callback - callback to be called after template is rendered.\r\n     * @param {String} mode - \"append\" means the template will be appended, provide any other value for\r\n     *                        replacing current contents of the element.\r\n     * @param {Function} validation - validation function.\r\n     */\r\n    obj.renderTemplate = function (templateUrl, el, data, callback, mode, validation) {\r\n        return obj.compileTemplate(templateUrl, data).then(function validateAndRender(template) {\r\n            if (validation && !validation()) {\r\n                return false;\r\n            }\r\n\r\n            if (mode === \"append\") {\r\n                el.append(template);\r\n            } else {\r\n                el.html(template);\r\n            }\r\n\r\n            if (callback) {\r\n                callback();\r\n            }\r\n        });\r\n    };\r\n\r\n     /**\r\n      * @deprecated\r\n      * @see Use {@link module:org/forgerock/commons/ui/common/util/UIUtils.compileTemplate}\r\n      */\r\n    obj.fillTemplateWithData = function (templateUrl, data, compileCallback) {\r\n        return obj.compileTemplate(templateUrl, data).then(compileCallback);\r\n    };\r\n\r\n    /**\r\n     * Compiles template and returns the result of compilation.\r\n     * @param {String} templateUrl - template url.\r\n     * @param {Object} data - template will be compiled with this data.\r\n     * @returns {Promise} compiled template wrapped in a promise\r\n     */\r\n    obj.compileTemplate = function (templateUrl, data) {\r\n        if (templateUrl) {\r\n            return ThemeManager.getTheme().then(function (theme) {\r\n                var templateUrlWithPath = theme.path + templateUrl,\r\n                    templateSavedPath = theme.path ? templateUrlWithPath : templateUrl;\r\n\r\n                if (obj.templates[templateSavedPath]) {\r\n                    return Handlebars.compile(obj.templates[templateSavedPath])(data);\r\n                } else if (theme.path) {\r\n                    return fetchAndCompileTemplate(templateUrlWithPath, templateUrlWithPath, data)\r\n                        .then(null, function fallBackToDefaultPath() {\r\n                            console.log(templateUrlWithPath + \" was not found. Trying \" + templateUrl);\r\n                            return fetchAndCompileTemplate(templateUrl, templateUrlWithPath, data);\r\n                        });\r\n                } else {\r\n                    return fetchAndCompileTemplate(templateUrl, templateUrl, data);\r\n                }\r\n            });\r\n        } else {\r\n            return $.Deferred().resolve(\"\");\r\n        }\r\n    };\r\n\r\n    /**\r\n    * Preloads templates for their later usage.\r\n    * @param {(String|String[])} urls - Urls to be preloaded, can be either a string or an array.\r\n    */\r\n    obj.preloadTemplates = function (urls) {\r\n        if (typeof urls === \"string\") {\r\n            urls = [urls];\r\n        }\r\n\r\n        return ThemeManager.getTheme().then(function (theme) {\r\n            var promises = [];\r\n\r\n            if (theme.path) {\r\n                _.each(urls, function (templateUrl) {\r\n                    var urlWithPath = theme.path + templateUrl;\r\n                    promises.push(\r\n                        fetchAndSaveTemplate(urlWithPath, urlWithPath).then(null, function fallBackToDefaultPath() {\r\n                            console.log(urlWithPath + \" was not found. Trying \" + templateUrl);\r\n                            promises.push(fetchAndSaveTemplate(templateUrl, urlWithPath));\r\n                        }));\r\n                });\r\n            } else {\r\n                _.each(urls, function (templateUrl) {\r\n                    promises.push(fetchAndSaveTemplate(templateUrl, templateUrl));\r\n                });\r\n            }\r\n\r\n            return $.when.apply($, promises);\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Loads all the templates defined in the \"templateUrls\" attribute of this module's configuration.\r\n     */\r\n    obj.preloadInitialTemplates = function() {\r\n        obj.preloadTemplates(obj.configuration.templateUrls);\r\n    };\r\n\r\n    /**\r\n     * Loads a Handlebars partial.\r\n     * <p>\r\n     * The registered name for the partial is inferred from the URL specified. e.g.\r\n     * \"partials/headers/_Title.html\" => \"headers/_Title\"\r\n     * <p>\r\n     * Will not reload and register partials that are already loaded and registered\r\n     * @param {String} url URL of partial to load in the format \"partials/<path_to_partial>.html\"\r\n     * @return {Promise.<Object>} Load promise\r\n     */\r\n    obj.preloadPartial = function (url) {\r\n        var name = url.replace(/(^partials\\/)|(\\.html$)/g, \"\");\r\n\r\n        return ThemeManager.getTheme().then(function (theme) {\r\n            if (Handlebars.partials[name]) {\r\n                return;\r\n            } else if (theme.path) {\r\n                return registerPartial(name, theme.path + url)\r\n                    .then(null, function fallBackToDefaultPath() {\r\n                        console.log(theme.path + url + \" was not found. Trying \" + url);\r\n                        return registerPartial(name, url);\r\n                    });\r\n            } else {\r\n                return registerPartial(name, url);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Loads all the Handlebars partials defined in the \"partialUrls\" attribute of this module's configuration\r\n     */\r\n    obj.preloadInitialPartials = function() {\r\n        _.each(obj.configuration.partialUrls, function(url) {\r\n            obj.preloadPartial(url);\r\n        });\r\n    };\r\n\r\n    $.fn.emptySelect = function() {\r\n        return this.each(function() {\r\n            if (this.tagName === \"SELECT\") {\r\n                this.options.length = 0;\r\n            }\r\n        });\r\n    };\r\n\r\n    $.fn.loadSelect = function(optionsDataArray) {\r\n        return this.emptySelect().each(function() {\r\n            if (this.tagName === \"SELECT\") {\r\n                var i, option, selectElement = this;\r\n                for(i = 0; i < optionsDataArray.length; i++){\r\n                    option = new Option(optionsDataArray[i].value, optionsDataArray[i].key);\r\n                    selectElement.options[selectElement.options.length] = option;\r\n                }\r\n            }\r\n        });\r\n    };\r\n\r\n    $.event.special.delayedkeyup = {\r\n        setup: function() {\r\n            $(this).bind(\"keyup\", $.event.special.delayedkeyup.handler);\r\n        },\r\n\r\n        teardown: function() {\r\n            $(this).unbind(\"keyup\", $.event.special.delayedkeyup.handler);\r\n        },\r\n\r\n        handler: function( event ) {\r\n            var self = this, args = arguments;\r\n\r\n            event.type = \"delayedkeyup\";\r\n\r\n            $.doTimeout(\"delayedkeyup\", 250, function() {\r\n                $.event.handle.apply(self, args);\r\n            });\r\n        }\r\n    };\r\n\r\n    //map should have format key : value\r\n    Handlebars.registerHelper(\"selectm\", function(map, elementName, selectedKey, selectedValue, multiple, height) {\r\n        var result, prePart, postPart, content = \"\", isSelected, entityName;\r\n\r\n        prePart = \"<select\";\r\n\r\n        if (elementName && _.isString(elementName)) {\r\n            prePart += ' name=\"' + elementName + '\"';\r\n        }\r\n\r\n        if(multiple) {\r\n            prePart += ' multiple=\"multiple\"';\r\n        }\r\n\r\n        if(height) {\r\n            prePart += ' style=\"height: '+ height +'px\"';\r\n        }\r\n\r\n        prePart += '>';\r\n\r\n        postPart = '</select> ';\r\n\r\n        for (entityName in map) {\r\n            isSelected = false;\r\n            if (selectedValue && _.isString(selectedValue)) {\r\n                if (selectedValue === map[entityName]) {\r\n                    isSelected = true;\r\n                }\r\n            } else if (selectedKey && selectedKey === entityName) {\r\n                isSelected = true;\r\n            }\r\n\r\n            if (isSelected) {\r\n                content += '<option value=\"' + entityName + '\" selected=\"true\">' + $.t(map[entityName]) + '</option>';\r\n            } else {\r\n                content += '<option value=\"' + entityName + '\">' + $.t(map[entityName]) + '</option>';\r\n            }\r\n        }\r\n\r\n        result = prePart + content + postPart;\r\n        return new Handlebars.SafeString(result);\r\n    });\r\n\r\n    /**\r\n     * Use this helper around a basic select to automatically\r\n     * mark the option corresponding to the provided value as selected.\r\n     *\r\n     * @example JS\r\n     *  this.data.mimeType = \"text/html\";\r\n     *\r\n     * @example HTML\r\n     *  <select>\r\n     *      {{#staticSelect mimeType}}\r\n     *      <option value=\"text/html\">text/html</option>\r\n     *      <option value=\"text/plain\">text/plain</option>\r\n     *      {{/staticSelect}}\r\n     *  </select>\r\n     */\r\n    Handlebars.registerHelper(\"staticSelect\", function(value, options){\r\n        var selected = $(\"<select />\").html(options.fn(this));\r\n        if (typeof value !== \"undefined\" && value !== null) {\r\n            selected.find(\"[value=\\'\" + value.toString().replace(\"'\", \"\\\\'\") + \"\\']\").attr({\"selected\":\"selected\"});\r\n        }\r\n        return selected.html();\r\n    });\r\n\r\n    Handlebars.registerHelper('select', function(map, elementName, selectedKey, selectedValue, additionalParams) {\r\n        var result, prePart, postPart, content = \"\", isSelected, entityName, entityKey;\r\n\r\n        if (map && _.isString(map)) {\r\n            map = JSON.parse(map);\r\n        }\r\n\r\n        if (elementName && _.isString(elementName)) {\r\n            prePart = '<select name=\"' + elementName + '\" ' + additionalParams + '>';\r\n        } else{\r\n            prePart = '<select>';\r\n        }\r\n\r\n        postPart = '</select> ';\r\n\r\n        for (entityName in map) {\r\n            isSelected = false;\r\n            if (selectedValue && _.isString(selectedValue) && selectedValue !== '') {\r\n                if (selectedValue === map[entityName]) {\r\n                    isSelected = true;\r\n                }\r\n            } else if (selectedKey && selectedKey !== '' && selectedKey === entityName) {\r\n                isSelected = true;\r\n            }\r\n\r\n            if (entityName === '__null') {\r\n                entityKey = '';\r\n            } else {\r\n                entityKey = entityName;\r\n            }\r\n\r\n            if (isSelected) {\r\n                content += '<option value=\"' + entityKey + '\" selected=\"true\">' + $.t(map[entityName]) + '</option>';\r\n            } else {\r\n                content += '<option value=\"' + entityKey + '\">' + $.t(map[entityName]) + '</option>';\r\n            }\r\n        }\r\n\r\n        result = prePart + content + postPart;\r\n        return new Handlebars.SafeString(result);\r\n    });\r\n\r\n    Handlebars.registerHelper('p', function(countValue, options) {\r\n        var params, result;\r\n        params = { count: countValue };\r\n        result = i18next.t(options.hash.key, params);\r\n        return new Handlebars.SafeString(result);\r\n    });\r\n\r\n\r\n    /**\r\n     * @description A handlebars helper checking the equality of two provided parameters, if\r\n     *      the parameters are not equal and there is an else block, the else block will be rendered.\r\n     *\r\n     * @example:\r\n     *\r\n     * {{#equals \"testParam\" \"testParam\"}}\r\n     *      <span>Equals Block!</span>\r\n     * {{else}}\r\n     *      <span> Not Equals Block!</span>\r\n     * {{/equals}}\r\n     */\r\n    Handlebars.registerHelper('equals', function(val, val2, options) {\r\n        if (val === val2) {\r\n            return options.fn(this);\r\n        } else {\r\n            return options.inverse(this);\r\n        }\r\n    });\r\n\r\n    Handlebars.registerHelper('checkbox', function(map, name) {\r\n        var ret = \"<div class='checkboxList' id='\"+name+\"'><ol>\", idx,\r\n            sortedMap = _.chain(map)\r\n                            .pairs()\r\n                            .sortBy(function (arr) { return arr[1]; })\r\n                            .value();\r\n\r\n        for(idx=0;idx<sortedMap.length;idx++) {\r\n            ret += '<li><input type=\"checkbox\" name=\"'+ name +'\" value=\"'+ sortedMap[idx][0] +'\" id=\"'+ name +'_'\r\n                + encodeURIComponent(sortedMap[idx][0]) +'\"><label for=\"'+ name +'_'\r\n                + encodeURIComponent(sortedMap[idx][0]) +'\">' + sortedMap[idx][1] + '</label></li>';\r\n        }\r\n\r\n        ret += \"</ol></div>\";\r\n\r\n        return new Handlebars.SafeString(ret);\r\n    });\r\n\r\n    Handlebars.registerHelper('siteImages', function(images) {\r\n        var ret = \"\", i;\r\n\r\n        for(i = 0; i < images.length; i++) {\r\n            ret += '<img class=\"item\" src=\"'\r\n                + encodeURI(images[i]) +'\" data-site-image=\"'\r\n                + encodeURI(images[i]) +'\" />';\r\n        }\r\n\r\n        return new Handlebars.SafeString(ret);\r\n    });\r\n\r\n    Handlebars.registerHelper(\"each_with_index\", function(array, fn) {\r\n        var buffer = \"\",\r\n            item,\r\n            k=0,\r\n            i=0,\r\n            j=0;\r\n\r\n        for (i = 0, j = array.length; i < j; i++) {\r\n            if (array[i]) {\r\n                item = {};\r\n                item.value = array[i];\r\n\r\n                // stick an index property onto the item, starting with 0\r\n                item.index = k;\r\n\r\n                item.first = (k === 0);\r\n                item.last = (k === array.length);\r\n\r\n                // show the inside of the block\r\n                buffer += fn.fn(item);\r\n\r\n                k++;\r\n            }\r\n        }\r\n\r\n        // return the finished buffer\r\n        return buffer;\r\n\r\n    });\r\n\r\n    Handlebars.registerHelper('camelCaseToTitle', function(string) {\r\n        var newString = string.replace(/([a-z])([A-Z])/g, '$1 $2');\r\n        return new Handlebars.SafeString(newString[0].toUpperCase() + newString.slice(1));\r\n    });\r\n\r\n    Handlebars.registerHelper('stringify', function(string, spaces) {\r\n        spaces = spaces ? spaces : 0 ;\r\n        var newString = JSON.stringify(string, null, spaces);\r\n        return newString;\r\n    });\r\n\r\n    Handlebars.registerHelper('ifObject', function(item, options) {\r\n        if(typeof item === 'object') {\r\n            return options.fn(this);\r\n        } else {\r\n            return options.inverse(this);\r\n        }\r\n    });\r\n\r\n    /**\r\n     * Handlebars 'urlTo' helper\r\n     * @returns {String} fragment from a given route key after applying arguments or default values.\r\n     *\r\n     * @example {{urlTo 'login'}} will return \"#login\"\r\n     */\r\n    Handlebars.registerHelper(\"urlTo\", function(routeKey) {\r\n        var args = [].concat(arguments[1]);\r\n        // Don't return a safe string to prevent XSS.\r\n        return \"#\" + Router.getLink(Router.configuration.routes[routeKey], args);\r\n    });\r\n\r\n    /**\r\n     * Handlebars 'routeTo' helper\r\n     * Creates a routing hash will all arguments passed through #encodeURIComponent\r\n     */\r\n    Handlebars.registerHelper('routeTo', function (routeKey) {\r\n        var result = '#',\r\n            args = _.toArray(arguments).slice(1, -1);\r\n        args = _.map(args, function (arg) {\r\n            return encodeURIComponent(arg);\r\n        });\r\n\r\n        result += Router.getLink(Router.configuration.routes[routeKey], args);\r\n\r\n        return new Handlebars.SafeString(result);\r\n    });\r\n\r\n    /**\r\n     * Handlebars \"partial\" helper\r\n     * @example\r\n     * {{partial this.partialName this}}\r\n     */\r\n    Handlebars.registerHelper(\"partial\", function(name, context) {\r\n        var partial = Handlebars.partials[name];\r\n\r\n        if(!partial) {\r\n            console.error(\"Handlebars \\\"partial\\\" helper unable to find partial \\\"\" + name + \"\\\"\");\r\n        } else {\r\n            return new Handlebars.SafeString(partial(context));\r\n        }\r\n    });\r\n\r\n    obj.loadSelectOptions = function(data, el, empty, callback) {\r\n        if( empty === undefined || empty === true ) {\r\n            data = [{\r\n                \"key\" : \"\",\r\n                \"value\" : $.t(\"common.form.pleaseSelect\")\r\n            }].concat(data);\r\n        }\r\n\r\n        el.loadSelect(data);\r\n\r\n        if(callback) {\r\n            callback(data);\r\n        }\r\n    };\r\n\r\n    //This function exists to catch any legacy jqConfirms.\r\n    //Once completly updated across the applications this function can be removed.\r\n    obj.jqConfirm = function(message, confirmCallback) {\r\n        this.confirmDialog(message, \"default\", confirmCallback);\r\n    };\r\n\r\n    /**\r\n     * @param {string} message The text provided in the main body of the dialog\r\n     * @param {string} type The type of dialog to display\r\n     * @param {Function} confirmCallback Fired when the confirm button is clicked\r\n     * default\r\n     * info\r\n     * primary\r\n     * success\r\n     * warning\r\n     * danger\r\n     *\r\n     * @example\r\n     *  UIUtils.confirmDialog($.t(\"templates.admin.ResourceEdit.confirmDelete\"), \"danger\",s _.bind(function(){\r\n     *      //Useful stuff here\r\n     *  }, this));\r\n     */\r\n    obj.confirmDialog = function(message, type, confirmCallback){\r\n        ModuleLoader.load(\"bootstrap-dialog\").then(function (BootstrapDialog) {\r\n            var btnType = \"btn-\" +type;\r\n\r\n            if(type === \"default\") {\r\n                btnType = \"btn-primary\";\r\n            }\r\n\r\n            BootstrapDialog.show({\r\n                title: $.t('common.form.confirm'),\r\n                type: \"type-\" +type,\r\n                message: message,\r\n                id: \"frConfirmationDialog\",\r\n                buttons: [\r\n                    {\r\n                        label: $.t('common.form.cancel'),\r\n                        id: \"frConfirmationDialogBtnClose\",\r\n                        action: function(dialog){\r\n                            dialog.close();\r\n                        }\r\n                    },\r\n                    {\r\n                        label: $.t('common.form.ok'),\r\n                        cssClass: btnType,\r\n                        id: \"frConfirmationDialogBtnOk\",\r\n                        action: function(dialog) {\r\n                            if(confirmCallback) {\r\n                                confirmCallback();\r\n                            }\r\n                            dialog.close();\r\n                        }\r\n                    }\r\n                ]\r\n            });\r\n        });\r\n    };\r\n\r\n    obj.responseMessageMatch = function(error, string){\r\n        var responseMessage = JSON.parse(error).message;\r\n        return responseMessage.indexOf(string) > -1;\r\n    };\r\n\r\n    // Registering global mixins\r\n\r\n    _.mixin({\r\n\r\n        /**\r\n         * findByValues takes a collection and returns a subset made up of objects where the given property name\r\n         * matches a value in the list.\r\n         * @returns {Array} subset of made up of {Object} where there is no match between the given property name and\r\n         *                  the values in the list.\r\n         * @example\r\n         *\r\n         *    var collections = [\r\n         *        {id: 1, stack: 'am'},\r\n         *        {id: 2, stack: 'dj'},\r\n         *        {id: 3, stack: 'idm'},\r\n         *        {id: 4, stack: 'api'},\r\n         *        {id: 5, stack: 'rest'}\r\n         *    ];\r\n         *\r\n         *    var filtered = _.findByValues(collections, \"id\", [1,3,4]);\r\n         *\r\n         *    filtered = [\r\n         *        {id: 1, stack: 'am'},\r\n         *        {id: 3, stack: 'idm'},\r\n         *        {id: 4, stack: 'api'}\r\n         *    ]\r\n         *\r\n         */\r\n        \"findByValues\": function(collection, property, values) {\r\n            return _.filter(collection, function(item) {\r\n                return _.contains(values, item[property]);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * Returns subset array from a collection\r\n         * @returns {Array} subset of made up of {Object} where there is no match between the given property name and\r\n         *                  the values in the list.\r\n         * @example\r\n         *\r\n         *    var filtered = _.removeByValues(collections, \"id\", [1,3,4]);\r\n         *\r\n         *    filtered = [\r\n         *        {id: 2, stack: 'dj'},\r\n         *        {id: 5, stack: 'rest'}\r\n         *    ]\r\n         *\r\n         */\r\n        \"removeByValues\": function(collection, property, values) {\r\n            return _.reject(collection, function(item) {\r\n                return _.contains(values, item[property]);\r\n            });\r\n        },\r\n\r\n        /**\r\n         * isUrl checks to see if string is a valid URL\r\n         * @returns {Boolean}\r\n         */\r\n        \"isUrl\": function(string){\r\n            var regexp = /(http|https):\\/\\/(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(\\/|\\/([\\w#!:.?+=&%@!\\-\\/]))?/;\r\n            return regexp.test(string);\r\n        }\r\n\r\n    });\r\n\r\n    return obj;\r\n});"]}