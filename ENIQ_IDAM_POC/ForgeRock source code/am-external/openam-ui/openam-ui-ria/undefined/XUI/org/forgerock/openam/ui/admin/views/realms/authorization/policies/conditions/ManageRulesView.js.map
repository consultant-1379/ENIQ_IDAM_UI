{"version":3,"sources":["../../../../../../../../../../../XUI/org/forgerock/openam/ui/admin/views/realms/authorization/policies/conditions/ManageRulesView.js"],"names":["define","$","_","AbstractView","EventManager","Constants","UIUtils","EditEnvironmentView","EditSubjectView","OperatorRulesView","LegacyListItemView","extend","template","noBaseTemplate","events","types","ENVIRONMENT","SUBJECT","LEGACY","localEntity","groupCounter","idPrefix","property","properties","initialize","prototype","call","preloadTemplates","map","filename","init","args","sortingInitialised","data","entity","buildList","self","newRule","operators","pluck","buildListItem","container","isArray","each","item","contains","type","render","idCount","setValue","isEmpty","getNewRule","getProperties","createListItem","$el","dropbox","clone","find","delegateEvents","initSorting","nestingSortable","group","element","exclude","delay","onMousedown","$item","_super","event","stopPropagation","target","nodeName","match","preventDefault","onDragStart","offset","pointer","rootGroup","editRuleView","adjustment","left","top","setInactive","buttons","addCondition","addOperator","focus","css","width","addClass","options","drop","hasClass","onDrag","position","onDrop","rule","clonedItem","newHeight","animeAttrs","height","backgroundColor","borderColor","before","outerWidth","animate","detach","removeClass","logical","rebindElement","save","isValidTarget","notValid","items","length","parent","itemData","serialize","$parent","$children","parentIsContainer","result","subContainers","editStart","disabledConditions","not","prop","editStop","next","remove","button","state","toggleClass","e","keyCode","operatorRules","droppableParent","onRuleRender","onSelect","onDelete","currentTarget","closest","paddingTop","paddingBottom","marginTop","marginBottom","opacity","toggleEditing","setFocus","is","conditionType","rules","get","operatorData","console","error","log","JSON","stringify","identifyDroppableLogical","rootLogical","nestedItems","nestedLogicals","nestedLogicalsLength","nestedRules","canHaveMultiple","notIsEmpty","i","filter","children","hide","show"],"mappings":";;AAAA;;;;;;;;;;;;;;;;AAgBAA,OAAO,CACH,QADG,EAEH,QAFG,EAGH,mDAHG,EAIH,mDAJG,EAKH,gDALG,EAMH,8CANG,EAOH,kGAPG,EAQH,8FARG,EASH,gGATG,EAUH,iGAVG;;AAYH;AACA,UAbG,CAAP,EAcG,UAACC,CAAD,EAAIC,CAAJ,EAAOC,YAAP,EAAqBC,YAArB,EAAmCC,SAAnC,EAA8CC,OAA9C,EAAuDC,mBAAvD,EAA4EC,eAA5E,EAA6FC,iBAA7F,EACCC,kBADD,EACwB;AAAE;;AAEzB,WAAOP,aAAaQ,MAAb,CAAoB;AACvBC,kBAAU,yFADa;AAEvBC,wBAAgB,IAFO;AAGvBC,gBAAQ;AACJ,0DAA8C,cAD1C;AAEJ,0DAA8C,cAF1C;AAGJ,yDAA6C,aAHzC;AAIJ,yDAA6C,aAJzC;AAKJ,6CAAiC,UAL7B;AAMJ,6CAAiC;AAN7B,SAHe;AAWvBC,eAAO;AACHC,yBAAa,iBADV;AAEHC,qBAAS,aAFN;AAGHC,oBAAQ;AAHL,SAXgB;;AAiBvBC,qBAAa,EAjBU;AAkBvBC,sBAAc,CAlBS;;AAoBvBC,kBAAU,EApBa;AAqBvBC,kBAAU,EArBa;AAsBvBC,oBAAY,EAtBW;;AAwBvBC,kBAxBuB,wBAwBT;AACVrB,yBAAasB,SAAb,CAAuBD,UAAvB,CAAkCE,IAAlC,CAAuC,IAAvC;;AAEA;AACApB,oBAAQqB,gBAAR,CACIzB,EAAE0B,GAAF,CAAM,CACF,mBADE,EACmB,qBADnB,EAC0C,sBAD1C,EACkE,oBADlE,EAEF,qBAFE,EAEqB,mBAFrB,EAE0C,kBAF1C,EAE8D,mBAF9D,EAGF,uBAHE,EAGuB,qBAHvB,EAG8C,yBAH9C,CAAN,EAIG,UAACC,QAAD,EAAc;AACb,2FAAyEA,QAAzE;AACH,aAND,CADJ;AASH,SArCsB;AAuCvBC,YAvCuB,gBAuCjBC,IAvCiB,EAuCXjB,MAvCW,EAuCH;AAChBZ,cAAES,MAAF,CAAS,KAAKG,MAAd,EAAsBA,MAAtB;AACAZ,cAAES,MAAF,CAASN,SAAT,EAAoB,KAAKU,KAAzB;;AAEA,iBAAKI,WAAL,GAAmB,IAAnB;AACA,iBAAKa,kBAAL,GAA0B,KAA1B;;AAEA,gBAAI,KAAKC,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,CAAJ,EAAqC;AACjC,qBAAKH,WAAL,GAAmB,KAAKc,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,CAAnB;AACH;AACJ,SAjDsB;AAmDvBa,iBAnDuB,uBAmDV;AACT,gBAAIC,OAAO,IAAX;AAAA,gBACIC,UAAU,IADd;AAAA,gBAEIC,YAAYpC,EAAEqC,KAAF,CAAQ,KAAKN,IAAL,CAAUK,SAAlB,EAA6B,OAA7B,CAFhB;AAAA,gBAGIf,aAAa,IAHjB;;AAKA,qBAASiB,aAAT,CAAwBP,IAAxB,EAA8BQ,SAA9B,EAAyC;AACrC,oBAAIvC,EAAEwC,OAAF,CAAUT,IAAV,MAAoB,KAAxB,EAA+B;AAC3BA,2BAAO,CAACA,IAAD,CAAP;AACH;;AAED/B,kBAAEyC,IAAF,CAAOV,IAAP,EAAa,UAAUW,IAAV,EAAgB;AACzB,wBAAIA,QAAQ1C,EAAE2C,QAAF,CAAWP,SAAX,EAAsBM,KAAKE,IAA3B,CAAZ,EAA8C;AAC1CT,kCAAU,IAAI5B,iBAAJ,EAAV;AACA4B,gCAAQU,MAAR,CAAeX,KAAKH,IAApB,EAA0BQ,SAA1B,EAAqCL,KAAKf,QAAL,GAAgBe,KAAKY,OAA1D,EAAmEZ,KAAKY,OAAL,KAAiB,CAApF;AACAX,gCAAQY,QAAR,CAAiBL,KAAKE,IAAtB;AACAV,6BAAKY,OAAL;AACH,qBALD,MAKO,IAAI,CAAC9C,EAAEgD,OAAF,CAAUN,IAAV,CAAL,EAAsB;AACzB,4BAAIA,KAAKE,IAAL,KAAczC,UAAUa,MAA5B,EAAoC;AAChCmB,sCAAU,IAAI3B,kBAAJ,EAAV;AACA2B,oCAAQU,MAAR,CAAeH,IAAf,EAAqBH,SAArB,EAAgCL,KAAKY,OAArC;AACH,yBAHD,MAGO;AACHX,sCAAUD,KAAKe,UAAL,EAAV;AACA5B,yCAAaa,KAAKgB,aAAL,EAAb;AACAf,oCAAQU,MAAR,CAAexB,UAAf,EAA2BkB,SAA3B,EAAsCL,KAAKY,OAA3C,EAAoDJ,IAApD;AACAP,oCAAQgB,cAAR,CAAuB9B,UAAvB,EAAmCc,QAAQiB,GAA3C;AACH;;AAEDlB,6BAAKY,OAAL;AACH;;AAED,wBAAIJ,QAAQA,KAAKR,KAAKb,UAAV,CAAZ,EAAmC;AAC/BiB,sCAAcI,KAAKR,KAAKb,UAAV,CAAd,EAAqCc,QAAQkB,OAA7C,EAAsDX,IAAtD;AACH,qBAFD,MAEO,IAAIA,QAAQA,KAAKR,KAAKd,QAAV,CAAZ,EAAiC;AACpCkB,sCAAcI,KAAKR,KAAKd,QAAV,CAAd,EAAmCe,QAAQkB,OAA3C,EAAoDX,IAApD;AACH;AACJ,iBAzBD;AA0BH;;AAED;;;;;;;AAOA,gBAAI,CAAC,KAAKzB,WAAN,IAAqBjB,EAAE2C,QAAF,CAAWP,SAAX,EAAsB,KAAKnB,WAAL,CAAiB2B,IAAvC,MAAiD,KAA1E,EAAiF;AAC7EvB,6BAAarB,EAAEsD,KAAF,CAAQ,KAAKrC,WAAb,CAAb;AACA,qBAAKA,WAAL,GAAmB,EAAE2B,MAAM,KAAR,EAAnB;AACA,qBAAK3B,WAAL,CAAiB,KAAKI,UAAtB,IAAoC,CAACA,UAAD,CAApC;AACH;;AAEDiB,0BAAc,KAAKrB,WAAnB,EAAgC,KAAKmC,GAAL,CAASG,IAAT,CAAc,gBAAd,CAAhC,EAAiE,IAAjE;AACA,iBAAKC,cAAL;AACH,SAzGsB;AA2GvBC,mBA3GuB,yBA2GR;AACX,gBAAIvB,OAAO,IAAX;;AAEA,iBAAKhB,YAAL;;AAEA,iBAAKkC,GAAL,CAASG,IAAT,CAAc,YAAd,EAA4BG,eAA5B,CAA4C;AACxCC,uBAAUzB,KAAK0B,OAAf,2BAA4C1B,KAAKhB,YADT;AAExC2C,yBAAS,gCAF+B;AAGxCC,uBAAO,GAHiC;;AAKxCC,2BALwC,uBAK3BC,KAL2B,EAKpBC,MALoB,EAKZC,KALY,EAKL;AAC/BA,0BAAMC,eAAN;AACA,wBAAI,CAACD,MAAME,MAAN,CAAaC,QAAb,CAAsBC,KAAtB,CAA4B,4BAA5B,CAAL,EAAgE;AAC5DJ,8BAAMK,cAAN;AACA,+BAAO,IAAP;AACH;AACJ,iBAXuC;;AAYxC;AACAC,2BAbwC,uBAa3B9B,IAb2B,EAarBH,SAbqB,EAaV;AAC1B,wBAAIkC,SAAS/B,KAAK+B,MAAL,EAAb;AAAA,wBACIC,UAAUnC,UAAUoC,SAAV,CAAoBD,OADlC;AAAA,wBAEIE,eAAe,IAFnB;AAGA1C,yBAAK2C,UAAL,GAAkB;AACdC,8BAAMJ,QAAQI,IAAR,GAAeL,OAAOK,IAAtB,GAA6B,CADrB;AAEdC,6BAAKL,QAAQK,GAAR,GAAcN,OAAOM;AAFZ,qBAAlB;;AAKA7C,yBAAK8C,WAAL,CAAiB9C,KAAK+C,OAAL,CAAaC,YAA9B,EAA4C,KAA5C;AACAhD,yBAAK8C,WAAL,CAAiB9C,KAAK+C,OAAL,CAAaE,WAA9B,EAA2C,KAA3C;;AAEAzC,yBAAK0C,KAAL;AACA1C,yBAAK2C,GAAL,CAAS,EAAEC,OAAO5C,KAAK4C,KAAL,EAAT,EAAT,EAAkCC,QAAlC,CAA2C,SAA3C;AACAxF,sBAAE,MAAF,EAAUwF,QAAV,CAAmB,UAAnB;;AAEA,wBAAI,CAAChD,UAAUiD,OAAV,CAAkBC,IAAnB,IAA2B/C,KAAKgD,QAAL,CAAc,MAAd,CAA/B,EAAsD;AAClDd,uCAAe7E,EAAEU,MAAF,CAAS,KAAT,EAAgBiC,IAAhB,EAAsBR,KAAKe,UAAL,EAAtB,CAAf;AACA2B,qCAAazB,cAAb,CAA4BjB,KAAKgB,aAAL,EAA5B,EAAkDR,IAAlD;AACH;AACJ,iBAjCuC;AAmCxCiD,sBAnCwC,kBAmChCjD,IAnCgC,EAmC1BkD,QAnC0B,EAmChB;AACpBlD,yBAAK2C,GAAL,CAAS;AACLP,8BAAMc,SAASd,IAAT,GAAgB5C,KAAK2C,UAAL,CAAgBC,IADjC;AAELC,6BAAKa,SAASb,GAAT,GAAe7C,KAAK2C,UAAL,CAAgBE;AAF/B,qBAAT;AAIH,iBAxCuC;AA0CxCc,sBA1CwC,kBA0ChCnD,IA1CgC,EA0C1BH,SA1C0B,EA0Cf0B,MA1Ce,EA0CP;AAC7B,wBAAI6B,OAAO,IAAX;AAAA,wBAAiBC,UAAjB;AAAA,wBAA6BC,SAA7B;AAAA,wBAAwCC,UAAxC;;AAEAF,iCAAahG,EAAE,OAAF,EAAWsF,GAAX,CAAe;AACxBa,gCAAQ,CADgB;AAExBC,yCAAiB,aAFO;AAGxBC,qCAAa;AAHW,qBAAf,CAAb;AAKA1D,yBAAK2D,MAAL,CAAYN,UAAZ;AACAC,gCAAYtD,KAAKwD,MAAL,EAAZ;AACAD,iCAAaF,WAAWH,QAAX,EAAb;AACAK,+BAAWX,KAAX,GAAmBS,WAAWO,UAAX,KAA0B,EAA7C;AACA5D,yBAAK6C,QAAL,CAAc,SAAd;AACAQ,+BAAWQ,OAAX,CAAmB,EAAE,UAAUP,SAAZ,EAAnB,EAA4C,GAA5C,EAAiD,QAAjD;AACAtD,yBAAK6D,OAAL,CAAaN,UAAb,EAAyB,GAAzB,EAA8B,YAAY;AACtCF,mCAAWS,MAAX;AACA9D,6BAAK+D,WAAL,CAAiB,SAAjB;;AAEA,4BAAI/D,KAAKX,IAAL,GAAY2E,OAAZ,KAAwB,IAA5B,EAAkC;AAC9BZ,mCAAO/F,EAAEU,MAAF,CAAS,KAAT,EAAgBiC,IAAhB,EAAsB,IAAInC,iBAAJ,EAAtB,CAAP;AACAuF,iCAAKa,aAAL;AACH;AACDjE,6BAAK0C,KAAL;AACAnB,+BAAOvB,IAAP,EAAaH,SAAb;AACAL,6BAAK0E,IAAL;AACH,qBAXD;;AAaA7G,sBAAE,MAAF,EAAU0G,WAAV,CAAsB,UAAtB;;AAEAvE,yBAAKsB,cAAL;AACH,iBAxEuC;AA0ExCqD,6BA1EwC,yBA0EzBnE,IA1EyB,EA0EnBH,SA1EmB,EA0ER;AAC5B,wBAAIuE,WAAWvE,UAAUwE,KAAV,CAAgBC,MAAhB,GAAyB,CAAzB,IACXzE,UAAU6B,MAAV,CAAiB6C,MAAjB,GAA0BlF,IAA1B,GAAiCmF,QADtB,IAEX3E,UAAU6B,MAAV,CAAiB6C,MAAjB,GAA0BlF,IAA1B,GAAiCmF,QAAjC,CAA0ChF,KAAKd,QAA/C,CAFW,IAGXsB,KAAKgD,QAAL,CAAc,kBAAd,CAHJ;;AAKA,2BAAO,CAACoB,QAAR;AACH,iBAjFuC;AAmFxCK,yBAnFwC,qBAmF7BC,OAnF6B,EAmFpBC,SAnFoB,EAmFTC,iBAnFS,EAmFU;AAC9C,wBAAIC,SAASxH,EAAEU,MAAF,CAAS,EAAT,EAAa2G,QAAQrF,IAAR,GAAemF,QAA5B,CAAb;;AAEA,wBAAII,iBAAJ,EAAuB;AACnB,+BAAOD,SAAP;AACH,qBAFD,MAEO,IAAIA,UAAU,CAAV,CAAJ,EAAkB;AACrB,4BAAIE,OAAOrF,KAAKb,UAAZ,CAAJ,EAA6B;AACzBkG,mCAAOrF,KAAKb,UAAZ,IAA0BgG,SAA1B;AACH,yBAFD,MAEO,IAAIE,OAAOrF,KAAKd,QAAZ,CAAJ,EAA2B;AAC9BmG,mCAAOrF,KAAKd,QAAZ,IAAwBiG,UAAU,CAAV,CAAxB;AACH;AACJ;;AAED,2BAAOE,OAAOC,aAAd;AACA,2BAAOD,OAAO7D,eAAd;AACA,2BAAO6D,MAAP;AACH;AAnGuC,aAA5C;;AAsGA,iBAAKzF,kBAAL,GAA0B,IAA1B;AACH,SAvNsB;AAyNvB2F,iBAzNuB,qBAyNZ/E,IAzNY,EAyNN;AACb3C,cAAE,MAAF,EAAUwF,QAAV,CAAmB,SAAnB;;AAEA,gBAAIrD,OAAO,IAAX;AAAA,gBACI0C,eAAe1C,KAAKe,UAAL,EADnB;AAAA,gBAEI5B,aAAaa,KAAKgB,aAAL,EAFjB;AAAA,gBAGIwE,kBAHJ;AAIA9C,yBAAa/B,MAAb,CAAoBxB,UAApB,EAAgCqB,KAAKuE,MAAL,EAAhC,EAA+C/E,KAAKY,OAApD,EAA6DJ,KAAKX,IAAL,GAAYmF,QAAzE;;AAEAhF,iBAAKY,OAAL;;AAEA8B,yBAAaxB,GAAb,CAAiBmC,QAAjB,CAA0B,SAA1B;AACA7C,iBAAK2D,MAAL,CAAYzB,aAAaxB,GAAzB;;AAEA,iBAAK4B,WAAL,CAAiB,KAAKC,OAAL,CAAaC,YAA9B,EAA4C,IAA5C;AACA,iBAAKF,WAAL,CAAiB,KAAKC,OAAL,CAAaE,WAA9B,EAA2C,IAA3C;;AAEAuC,iCAAqB,KAAKtE,GAAL,CAASG,IAAT,CAAc,kBAAd,EAAkCoE,GAAlC,CAAsC,UAAtC,CAArB;AACAD,+BAAmBnC,QAAnB,CAA4B,kBAA5B;AACAmC,+BAAmBnE,IAAnB,CAAwB,UAAxB,EAAoCqE,IAApC,CAAyC,UAAzC,EAAqD,IAArD;;AAEAhD,yBAAaxB,GAAb,CAAiBG,IAAjB,CAAsB,6BAAtB,EAAqD6B,KAArD;AACH,SA/OsB;AAiPvByC,gBAjPuB,oBAiPbnF,IAjPa,EAiPP;AACZ3C,cAAE,MAAF,EAAU0G,WAAV,CAAsB,SAAtB;;AAEA,gBAAI7B,eAAe7E,EAAEU,MAAF,CAAS,KAAT,EAAgBiC,IAAhB,EAAsB,KAAKO,UAAL,EAAtB,CAAnB;AAAA,gBACI5B,aAAa,KAAK6B,aAAL,EADjB;AAAA,gBAEIwE,kBAFJ;;AAIA9C,yBAAazB,cAAb,CAA4B9B,UAA5B,EAAwCqB,IAAxC;;AAEAA,iBAAKoF,IAAL,GAAYC,MAAZ;AACA,iBAAKnB,IAAL;;AAEAc,iCAAqB,KAAKtE,GAAL,CAASG,IAAT,CAAc,kBAAd,EAAkCoE,GAAlC,CAAsC,UAAtC,CAArB;AACAD,+BAAmBjB,WAAnB,CAA+B,kBAA/B;AACAiB,+BAAmBnE,IAAnB,CAAwB,UAAxB,EAAoCqE,IAApC,CAAyC,UAAzC,EAAqD,KAArD;AACH,SAhQsB;AAkQvB5C,mBAlQuB,uBAkQVgD,MAlQU,EAkQFC,KAlQE,EAkQK;AACxBD,mBAAOE,WAAP,CAAmB,UAAnB,EAA+BD,KAA/B;AACH,SApQsB;AAsQvB9C,mBAtQuB,uBAsQVgD,CAtQU,EAsQP;AACZA,cAAE5D,cAAF;;AAEA,gBAAI4D,EAAEvF,IAAF,KAAW,OAAX,IAAsBuF,EAAEC,OAAF,KAAc,EAAxC,EAA4C;AACxC;AACH;;AAED,gBAAIC,gBAAgB,IAAI9H,iBAAJ,EAApB;AACA8H,0BAAcxF,MAAd,CAAqB,KAAKd,IAA1B,EAAgC,KAAKuG,eAArC,EAAsD,KAAKnH,QAAL,GAAgB,KAAK2B,OAA3E;;AAEA,iBAAKA,OAAL;AACH,SAjRsB;AAmRvBoC,oBAnRuB,wBAmRTiD,CAnRS,EAmRN;AACbA,cAAE5D,cAAF;;AAEA,gBAAI4D,EAAEvF,IAAF,KAAW,OAAX,IAAsBuF,EAAEC,OAAF,KAAc,EAAxC,EAA4C;AACxC;AACH;;AAED,gBAAIxD,eAAe,KAAK3B,UAAL,EAAnB;AAAA,gBACIf,OAAO,IADX;;AAGA0C,yBAAa/B,MAAb,CAAoB,KAAKK,aAAL,EAApB,EAA0C,KAAKoF,eAA/C,EAAgE,KAAKxF,OAArE,EAA8E,IAA9E,EACI,SAASyF,YAAT,GAAyB;AACrBrG,qBAAKuF,SAAL,CAAe7C,aAAaxB,GAA5B;AACAlB,qBAAKkB,GAAL,CAASG,IAAT,CAAc,YAAd,EAA4BG,eAA5B,CAA4C,SAA5C;AACH,aAJL;;AAMA,iBAAKZ,OAAL;AACH,SApSsB;AAsSvB0F,gBAtSuB,oBAsSbL,CAtSa,EAsSV;AACTA,cAAEhE,eAAF;AACA,iBAAKyC,IAAL;AACH,SAzSsB;AA2SvB6B,gBA3SuB,oBA2SbN,CA3Sa,EA2SV;AACTA,cAAEhE,eAAF;;AAEA,gBAAIgE,EAAEvF,IAAF,KAAW,OAAX,IAAsBuF,EAAEC,OAAF,KAAc,EAAxC,EAA4C;AACxC;AACH;;AAED,gBAAIlG,OAAO,IAAX;AAAA,gBACIQ,OAAO3C,EAAEoI,EAAEO,aAAJ,EAAmBC,OAAnB,CAA2B,IAA3B,CADX;AAAA,gBAEIjB,kBAFJ;;AAIAhF,iBAAK6D,OAAL,CAAa;AACTL,wBAAQ,CADC,EACE0C,YAAY,CADd,EACiBC,eAAe,CADhC;AAETC,2BAAW,CAFF,EAEKC,cAAc,CAFnB,EAEsBC,SAAS;AAF/B,aAAb,EAGG,YAAY;AACX;AACA,oBAAIjJ,EAAE,MAAF,EAAU2F,QAAV,CAAmB,SAAnB,CAAJ,EAAmC;AAC/B3F,sBAAE,MAAF,EAAU0G,WAAV,CAAsB,SAAtB;AACA/D,yBAAKoF,IAAL,GAAYC,MAAZ;;AAEAL,yCAAqBxF,KAAKkB,GAAL,CAASG,IAAT,CAAc,kBAAd,EAAkCoE,GAAlC,CAAsC,UAAtC,CAArB;AACAD,uCAAmBjB,WAAnB,CAA+B,kBAA/B;AACAiB,uCAAmBnE,IAAnB,CAAwB,UAAxB,EAAoCqE,IAApC,CAAyC,UAAzC,EAAqD,KAArD;AACH;;AAEDlF,qBAAKqF,MAAL;AACA7F,qBAAK0E,IAAL;AACH,aAhBD;AAiBH,SAvUsB;AAyUvBqC,qBAzUuB,yBAyURd,CAzUQ,EAyUL;AACd,gBAAIA,EAAEvF,IAAF,KAAW,OAAX,IAAsBuF,EAAEC,OAAF,KAAc,EAAxC,EAA4C;AACxC;AACH;;AAED,gBAAI1F,OAAO3C,EAAEoI,EAAEO,aAAJ,EAAmBC,OAAnB,CAA2B,IAA3B,CAAX;;AAEA,gBAAIjG,KAAKgD,QAAL,CAAc,kBAAd,CAAJ,EAAuC;AACnC;AACH;;AAED,gBAAIhD,KAAKgD,QAAL,CAAc,SAAd,CAAJ,EAA8B;AAC1BhD,qBAAK+D,WAAL,CAAiB,SAAjB;AACA,qBAAKoB,QAAL,CAAcnF,IAAd;AACH,aAHD,MAGO;AACH,qBAAK+E,SAAL,CAAe/E,IAAf;AACH;AACJ,SA1VsB;AA4VvBwG,gBA5VuB,oBA4Vbf,CA5Va,EA4VV;AACTA,cAAEhE,eAAF;AACA,gBAAIC,SAASrE,EAAEoI,EAAE/D,MAAJ,EAAY+E,EAAZ,CAAe,QAAf,KAA4BpJ,EAAEoI,EAAE/D,MAAJ,EAAY+E,EAAZ,CAAe,OAAf,CAA5B,GAAsDhB,EAAE/D,MAAxD,GAAiE+D,EAAEO,aAAhF;AACA3I,cAAEqE,MAAF,EAAUgB,KAAV;AACH,SAhWsB;AAkWvBnC,kBAlWuB,wBAkWT;AACV,mBAAO,KAAKmG,aAAL,KAAuBjJ,UAAUW,WAAjC,GAA+C,IAAIT,mBAAJ,EAA/C,GAA2E,IAAIC,eAAJ,EAAlF;AACH,SApWsB;AAsWvB4C,qBAtWuB,2BAsWN;AACb,gBAAI7B,aAAa,EAAjB;AACAA,uBAAW,KAAKA,UAAhB,IAA8B,KAAKU,IAAL,CAAU,KAAKV,UAAf,CAA9B;AACA,mBAAOA,UAAP;AACH,SA1WsB;AA4WvBuF,YA5WuB,kBA4Wf;AACJ,gBAAI,KAAK9E,kBAAL,KAA4B,IAAhC,EAAsC;AAClC;AACH;;AAED,gBAAIuH,QAAQ,KAAKjG,GAAL,CAASG,IAAT,CAAc,YAAd,EAA4BG,eAA5B,CAA4C,WAA5C,EAAyD4F,GAAzD,EAAZ;AAAA,gBACIC,eAAe,KAAKnG,GAAL,CAASG,IAAT,eAA0B,KAAKpC,QAA/B,QAA4CY,IAA5C,GAAmDmF,QADtE;;AAGA;AACA,gBAAIqC,aAAa,KAAKlI,UAAlB,CAAJ,EAAmC;AAC/B,oBAAIgI,MAAMrC,MAAN,IAAgB,CAApB,EAAuB;AACnB,yBAAKjF,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,IAAkCpB,EAAEgD,OAAF,CAAUqG,MAAM,CAAN,CAAV,IAAsB,IAAtB,GAA6BA,MAAM,CAAN,CAA/D;AACH,iBAFD,MAEO;AACHE,iCAAa,KAAKlI,UAAlB,IAAgCgI,KAAhC;AACA,yBAAKtH,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,IAAkCmI,YAAlC;AACH;AACJ,aAPD,MAOO,IAAIA,aAAa,KAAKnI,QAAlB,CAAJ,EAAiC;AACpC,oBAAIiI,MAAM,CAAN,KAAY,CAACrJ,EAAEgD,OAAF,CAAUqG,MAAM,CAAN,CAAV,CAAjB,EAAsC;AAClC,yBAAKtH,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,IAAkCmI,YAAlC;AACA,yBAAKxH,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,EAAgC,KAAKA,QAArC,IAAiDiI,MAAM,CAAN,CAAjD;AACH,iBAHD,MAGO;AACH,yBAAKtH,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,IAAkC,IAAlC;AACH;AACJ,aAPM,MAOA,IAAImI,aAAa,KAAKnI,QAAlB,MAAgC,IAApC,EAA0C;AAC7C,qBAAKW,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,IAAkC,IAAlC;AACH,aAFM,MAEA;AACHoI,wBAAQC,KAAR,CAAc,gCAAd,EAAgD,KAAKrI,QAArD,EAA+DmI,YAA/D;AACH;;AAEDC,oBAAQE,GAAR,QAAiB,KAAKtI,QAAtB,QAAmCuI,KAAKC,SAAL,CAAe,KAAK7H,IAAL,CAAUC,MAAV,CAAiB,KAAKZ,QAAtB,CAAf,EAAgD,IAAhD,EAAsD,CAAtD,CAAnC;;AAEA,iBAAKyI,wBAAL;AACH,SA5YsB;;;AA8YvB;;;;AAIAA,gCAlZuB,sCAkZK;AACxB,gBAAIC,cAAc,KAAK1G,GAAL,CAASG,IAAT,eAA0B,KAAKpC,QAA/B,OAAlB;AAAA,gBACI4I,WADJ;AAAA,gBAEIC,cAFJ;AAAA,gBAGIC,oBAHJ;AAAA,gBAIIC,WAJJ;AAAA,gBAKIxD,OALJ;AAAA,gBAMIyD,eANJ;AAAA,gBAOIC,UAPJ;AAAA,gBAQIC,IAAI,CARR;;AAUA,iBAAK/B,eAAL,GAAuB,IAAvB;;AAEA,gBAAIwB,YAAYpE,QAAZ,CAAqB,KAArB,CAAJ,EAAiC;AAC7BqE,8BAAcD,YAAYvG,IAAZ,CAAiB,IAAjB,CAAd;AACAyG,iCAAiBD,YAAYO,MAAZ,CAAmB,WAAnB,EAAgChB,GAAhC,EAAjB;AACAW,uCAAuBD,eAAehD,MAAtC;AACAkD,8BAAcH,YAAYO,MAAZ,CAAmB,OAAnB,EAA4BhB,GAA5B,EAAd;;AAEA,oBAAIW,oBAAJ,EAA0B;AACtB;AACA;AACA,2BAAOI,IAAIJ,oBAAX,EAAiCI,GAAjC,EAAsC;AAClC3D,kCAAU3G,EAAEiK,eAAeK,CAAf,CAAF,CAAV;;AAEA;AACAF,0CAAkBzD,QAAQhB,QAAR,CAAiB,KAAjB,KAA2BgB,QAAQhB,QAAR,CAAiB,IAAjB,CAA7C;AACA;AACA0E,qCAAa1D,QAAQhB,QAAR,CAAiB,KAAjB,KACTgB,QAAQ6D,QAAR,CAAiB,UAAjB,EAA6BA,QAA7B,CAAsC,IAAtC,EAA4CvD,MAA5C,KAAuD,CAD3D;;AAGA,4BAAImD,mBAAmBC,UAAvB,EAAmC;AAC/B,iCAAK9B,eAAL,GAAuB5B,QAAQ6D,QAAR,CAAiB,UAAjB,CAAvB;AACA;AACH;AACJ;AACJ,iBAjBD,MAiBO,IAAIL,YAAYlD,MAAZ,KAAuB,CAA3B,EAA8B;AACjC;AACA,yBAAKsB,eAAL,GAAuBwB,YAAYS,QAAZ,CAAqB,UAArB,CAAvB;AACH;AACJ,aA3BD,MA2BO;AACH;AACA,qBAAKjC,eAAL,GAAuBwB,YAAYS,QAAZ,CAAqB,UAArB,CAAvB;AACH;;AAED,gBAAI,KAAKjC,eAAT,EAA0B;AACtB,qBAAKtD,WAAL,CAAiB,KAAKC,OAAL,CAAaC,YAA9B,EAA4C,KAA5C;AACA,qBAAKF,WAAL,CAAiB,KAAKC,OAAL,CAAaE,WAA9B,EAA2C,KAA3C;AACA,qBAAK/B,GAAL,CAASG,IAAT,CAAc,uBAAd,EAAuCiH,IAAvC;AACH,aAJD,MAIO;AACH,qBAAKxF,WAAL,CAAiB,KAAKC,OAAL,CAAaC,YAA9B,EAA4C,IAA5C;AACA,qBAAKF,WAAL,CAAiB,KAAKC,OAAL,CAAaE,WAA9B,EAA2C,IAA3C;AACA,qBAAK/B,GAAL,CAASG,IAAT,CAAc,uBAAd,EAAuCkH,IAAvC;AACH;AACJ;AAxcsB,KAApB,CAAP;AA0cH,CA3dD","file":"ManageRulesView.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2014-2017 ForgeRock AS.\n */\n\ndefine([\n    \"jquery\",\n    \"lodash\",\n    \"org/forgerock/commons/ui/common/main/AbstractView\",\n    \"org/forgerock/commons/ui/common/main/EventManager\",\n    \"org/forgerock/commons/ui/common/util/Constants\",\n    \"org/forgerock/commons/ui/common/util/UIUtils\",\n    \"org/forgerock/openam/ui/admin/views/realms/authorization/policies/conditions/EditEnvironmentView\",\n    \"org/forgerock/openam/ui/admin/views/realms/authorization/policies/conditions/EditSubjectView\",\n    \"org/forgerock/openam/ui/admin/views/realms/authorization/policies/conditions/OperatorRulesView\",\n    \"org/forgerock/openam/ui/admin/views/realms/authorization/policies/conditions/LegacyListItemView\",\n\n    // jquery dependencies\n    \"sortable\"\n], ($, _, AbstractView, EventManager, Constants, UIUtils, EditEnvironmentView, EditSubjectView, OperatorRulesView,\n    LegacyListItemView) => { // eslint-disable-line padded-blocks\n\n    return AbstractView.extend({\n        template: \"templates/admin/views/realms/authorization/policies/conditions/ManageRulesTemplate.html\",\n        noBaseTemplate: true,\n        events: {\n            \"click  [data-add-condition]:not(.disabled)\": \"addCondition\",\n            \"keyup  [data-add-condition]:not(.disabled)\": \"addCondition\",\n            \"click  [data-add-operator]:not(.disabled)\": \"addOperator\",\n            \"keyup  [data-add-operator]:not(.disabled)\": \"addOperator\",\n            \"click  [data-delete-operator]\": \"onDelete\",\n            \"keyup  [data-delete-operator]\": \"onDelete\"\n        },\n        types: {\n            ENVIRONMENT: \"environmentType\",\n            SUBJECT: \"subjectType\",\n            LEGACY: \"Policy\"\n        },\n\n        localEntity: {},\n        groupCounter: 0,\n\n        idPrefix: \"\",\n        property: \"\",\n        properties: \"\",\n\n        initialize () {\n            AbstractView.prototype.initialize.call(this);\n\n            // Needed for correct work of animation\n            UIUtils.preloadTemplates(\n                _.map([\n                    \"ConditionAttrEnum\", \"ConditionAttrString\", \"ConditionAttrBoolean\", \"ConditionAttrArray\",\n                    \"ConditionAttrObject\", \"ConditionAttrTime\", \"ConditionAttrDay\", \"ConditionAttrDate\",\n                    \"OperatorRulesTemplate\", \"EditSubjectTemplate\", \"EditEnvironmentTemplate\"\n                ], (filename) => {\n                    return `templates/admin/views/realms/authorization/policies/conditions/${filename}.html`;\n                })\n            );\n        },\n\n        init (args, events) {\n            _.extend(this.events, events);\n            _.extend(Constants, this.types);\n\n            this.localEntity = null;\n            this.sortingInitialised = false;\n\n            if (this.data.entity[this.property]) {\n                this.localEntity = this.data.entity[this.property];\n            }\n        },\n\n        buildList () {\n            var self = this,\n                newRule = null,\n                operators = _.pluck(this.data.operators, \"title\"),\n                properties = null;\n\n            function buildListItem (data, container) {\n                if (_.isArray(data) === false) {\n                    data = [data];\n                }\n\n                _.each(data, function (item) {\n                    if (item && _.contains(operators, item.type)) {\n                        newRule = new OperatorRulesView();\n                        newRule.render(self.data, container, self.idPrefix + self.idCount, self.idCount === 0);\n                        newRule.setValue(item.type);\n                        self.idCount++;\n                    } else if (!_.isEmpty(item)) {\n                        if (item.type === Constants.LEGACY) {\n                            newRule = new LegacyListItemView();\n                            newRule.render(item, container, self.idCount);\n                        } else {\n                            newRule = self.getNewRule();\n                            properties = self.getProperties();\n                            newRule.render(properties, container, self.idCount, item);\n                            newRule.createListItem(properties, newRule.$el);\n                        }\n\n                        self.idCount++;\n                    }\n\n                    if (item && item[self.properties]) {\n                        buildListItem(item[self.properties], newRule.dropbox, item);\n                    } else if (item && item[self.property]) {\n                        buildListItem(item[self.property], newRule.dropbox, item);\n                    }\n                });\n            }\n\n            /*\n             * This view will detect if the preserved rule begins with a logical. If it doesn't, an AND logical will be\n             * added to the root to give the users somewhere to drop rules into.\n             * However if the root logical is obsolete, for example it is one which expects many children but contains\n             * one or less, the root logical will be striped from the json before it is saved.\n             */\n\n            if (!this.localEntity || _.contains(operators, this.localEntity.type) === false) {\n                properties = _.clone(this.localEntity);\n                this.localEntity = { type: \"AND\" };\n                this.localEntity[this.properties] = [properties];\n            }\n\n            buildListItem(this.localEntity, this.$el.find(\"ol#dropOffArea\"), null);\n            this.delegateEvents();\n        },\n\n        initSorting () {\n            var self = this;\n\n            this.groupCounter++;\n\n            this.$el.find(\"ol#dropbox\").nestingSortable({\n                group: `${self.element}rule-creation-group${self.groupCounter}`,\n                exclude: \".item-button-panel, li.editing\",\n                delay: 100,\n\n                onMousedown ($item, _super, event) {\n                    event.stopPropagation();\n                    if (!event.target.nodeName.match(/^(input|select|textarea)$/i)) {\n                        event.preventDefault();\n                        return true;\n                    }\n                },\n                // set item relative to cursor position\n                onDragStart (item, container) {\n                    var offset = item.offset(),\n                        pointer = container.rootGroup.pointer,\n                        editRuleView = null;\n                    self.adjustment = {\n                        left: pointer.left - offset.left + 5,\n                        top: pointer.top - offset.top\n                    };\n\n                    self.setInactive(self.buttons.addCondition, false);\n                    self.setInactive(self.buttons.addOperator, false);\n\n                    item.focus();\n                    item.css({ width: item.width() }).addClass(\"dragged\");\n                    $(\"body\").addClass(\"dragging\");\n\n                    if (!container.options.drop && item.hasClass(\"rule\")) {\n                        editRuleView = $.extend(false, item, self.getNewRule());\n                        editRuleView.createListItem(self.getProperties(), item);\n                    }\n                },\n\n                onDrag (item, position) {\n                    item.css({\n                        left: position.left - self.adjustment.left,\n                        top: position.top - self.adjustment.top\n                    });\n                },\n\n                onDrop (item, container, _super) {\n                    var rule = null, clonedItem, newHeight, animeAttrs;\n\n                    clonedItem = $(\"<li/>\").css({\n                        height: 0,\n                        backgroundColor: \"transparent\",\n                        borderColor: \"transparent\"\n                    });\n                    item.before(clonedItem);\n                    newHeight = item.height();\n                    animeAttrs = clonedItem.position();\n                    animeAttrs.width = clonedItem.outerWidth() - 10;\n                    item.addClass(\"dropped\");\n                    clonedItem.animate({ \"height\": newHeight }, 300, \"linear\");\n                    item.animate(animeAttrs, 300, function () {\n                        clonedItem.detach();\n                        item.removeClass(\"dropped\");\n\n                        if (item.data().logical === true) {\n                            rule = $.extend(false, item, new OperatorRulesView());\n                            rule.rebindElement();\n                        }\n                        item.focus();\n                        _super(item, container);\n                        self.save();\n                    });\n\n                    $(\"body\").removeClass(\"dragging\");\n\n                    self.delegateEvents();\n                },\n\n                isValidTarget (item, container) {\n                    var notValid = container.items.length > 0 &&\n                        container.target.parent().data().itemData &&\n                        container.target.parent().data().itemData[self.property] ||\n                        item.hasClass(\"editing-disabled\");\n\n                    return !notValid;\n                },\n\n                serialize ($parent, $children, parentIsContainer) {\n                    var result = $.extend({}, $parent.data().itemData);\n\n                    if (parentIsContainer) {\n                        return $children;\n                    } else if ($children[0]) {\n                        if (result[self.properties]) {\n                            result[self.properties] = $children;\n                        } else if (result[self.property]) {\n                            result[self.property] = $children[0];\n                        }\n                    }\n\n                    delete result.subContainers;\n                    delete result.nestingSortable;\n                    return result;\n                }\n            });\n\n            this.sortingInitialised = true;\n        },\n\n        editStart (item) {\n            $(\"body\").addClass(\"editing\");\n\n            var self = this,\n                editRuleView = self.getNewRule(),\n                properties = self.getProperties(),\n                disabledConditions;\n            editRuleView.render(properties, item.parent(), self.idCount, item.data().itemData);\n\n            self.idCount++;\n\n            editRuleView.$el.addClass(\"editing\");\n            item.before(editRuleView.$el);\n\n            this.setInactive(this.buttons.addCondition, true);\n            this.setInactive(this.buttons.addOperator, true);\n\n            disabledConditions = this.$el.find(\".rule, .operator\").not(\".editing\");\n            disabledConditions.addClass(\"editing-disabled\");\n            disabledConditions.find(\"> select\").prop(\"disabled\", true);\n\n            editRuleView.$el.find(\"select.type-selection:first\").focus();\n        },\n\n        editStop (item) {\n            $(\"body\").removeClass(\"editing\");\n\n            var editRuleView = $.extend(false, item, this.getNewRule()),\n                properties = this.getProperties(),\n                disabledConditions;\n\n            editRuleView.createListItem(properties, item);\n\n            item.next().remove();\n            this.save();\n\n            disabledConditions = this.$el.find(\".rule, .operator\").not(\".editing\");\n            disabledConditions.removeClass(\"editing-disabled\");\n            disabledConditions.find(\"> select\").prop(\"disabled\", false);\n        },\n\n        setInactive (button, state) {\n            button.toggleClass(\"disabled\", state);\n        },\n\n        addOperator (e) {\n            e.preventDefault();\n\n            if (e.type === \"keyup\" && e.keyCode !== 13) {\n                return;\n            }\n\n            var operatorRules = new OperatorRulesView();\n            operatorRules.render(this.data, this.droppableParent, this.idPrefix + this.idCount);\n\n            this.idCount++;\n        },\n\n        addCondition (e) {\n            e.preventDefault();\n\n            if (e.type === \"keyup\" && e.keyCode !== 13) {\n                return;\n            }\n\n            var editRuleView = this.getNewRule(),\n                self = this;\n\n            editRuleView.render(this.getProperties(), this.droppableParent, this.idCount, null,\n                function onRuleRender () {\n                    self.editStart(editRuleView.$el);\n                    self.$el.find(\"ol#dropbox\").nestingSortable(\"refresh\");\n                });\n\n            this.idCount++;\n        },\n\n        onSelect (e) {\n            e.stopPropagation();\n            this.save();\n        },\n\n        onDelete (e) {\n            e.stopPropagation();\n\n            if (e.type === \"keyup\" && e.keyCode !== 13) {\n                return;\n            }\n\n            var self = this,\n                item = $(e.currentTarget).closest(\"li\"),\n                disabledConditions;\n\n            item.animate({\n                height: 0, paddingTop: 0, paddingBottom: 0,\n                marginTop: 0, marginBottom: 0, opacity: 0\n            }, function () {\n                // if deleted on edit step\n                if ($(\"body\").hasClass(\"editing\")) {\n                    $(\"body\").removeClass(\"editing\");\n                    item.next().remove();\n\n                    disabledConditions = self.$el.find(\".rule, .operator\").not(\".editing\");\n                    disabledConditions.removeClass(\"editing-disabled\");\n                    disabledConditions.find(\"> select\").prop(\"disabled\", false);\n                }\n\n                item.remove();\n                self.save();\n            });\n        },\n\n        toggleEditing (e) {\n            if (e.type === \"keyup\" && e.keyCode !== 13) {\n                return;\n            }\n\n            var item = $(e.currentTarget).closest(\"li\");\n\n            if (item.hasClass(\"editing-disabled\")) {\n                return;\n            }\n\n            if (item.hasClass(\"editing\")) {\n                item.removeClass(\"editing\");\n                this.editStop(item);\n            } else {\n                this.editStart(item);\n            }\n        },\n\n        setFocus (e) {\n            e.stopPropagation();\n            var target = $(e.target).is(\"select\") || $(e.target).is(\"input\") ? e.target : e.currentTarget;\n            $(target).focus();\n        },\n\n        getNewRule () {\n            return this.conditionType === Constants.ENVIRONMENT ? new EditEnvironmentView() : new EditSubjectView();\n        },\n\n        getProperties () {\n            var properties = {};\n            properties[this.properties] = this.data[this.properties];\n            return properties;\n        },\n\n        save () {\n            if (this.sortingInitialised !== true) {\n                return;\n            }\n\n            var rules = this.$el.find(\"ol#dropbox\").nestingSortable(\"serialize\").get(),\n                operatorData = this.$el.find(`#operator${this.idPrefix}0`).data().itemData;\n\n            // Removing any obsolete root logicals.\n            if (operatorData[this.properties]) {\n                if (rules.length <= 1) {\n                    this.data.entity[this.property] = _.isEmpty(rules[0]) ? null : rules[0];\n                } else {\n                    operatorData[this.properties] = rules;\n                    this.data.entity[this.property] = operatorData;\n                }\n            } else if (operatorData[this.property]) {\n                if (rules[0] && !_.isEmpty(rules[0])) {\n                    this.data.entity[this.property] = operatorData;\n                    this.data.entity[this.property][this.property] = rules[0];\n                } else {\n                    this.data.entity[this.property] = null;\n                }\n            } else if (operatorData[this.property] === null) {\n                this.data.entity[this.property] = null;\n            } else {\n                console.error(\"This should never be triggered\", this.property, operatorData);\n            }\n\n            console.log(`\\n${this.property}:`, JSON.stringify(this.data.entity[this.property], null, 2));\n\n            this.identifyDroppableLogical();\n        },\n\n        /**\n         * Searches for the most outer possible dropabble logical container that will be used as a drop target. If such\n         * container was not found, disables \"Add\" buttons and displays corresponding message.\n         */\n        identifyDroppableLogical () {\n            var rootLogical = this.$el.find(`#operator${this.idPrefix}0`),\n                nestedItems,\n                nestedLogicals,\n                nestedLogicalsLength,\n                nestedRules,\n                logical,\n                canHaveMultiple,\n                notIsEmpty,\n                i = 0;\n\n            this.droppableParent = null;\n\n            if (rootLogical.hasClass(\"not\")) {\n                nestedItems = rootLogical.find(\"li\");\n                nestedLogicals = nestedItems.filter(\".operator\").get();\n                nestedLogicalsLength = nestedLogicals.length;\n                nestedRules = nestedItems.filter(\".rule\").get();\n\n                if (nestedLogicalsLength) {\n                    // loop through nested logicals and return first one which is either an \"AND\"/\"OR\"\n                    // or \"NOT\" without children\n                    for (; i < nestedLogicalsLength; i++) {\n                        logical = $(nestedLogicals[i]);\n\n                        // \"AND\" or \"OR\" can have multiple children\n                        canHaveMultiple = logical.hasClass(\"and\") || logical.hasClass(\"or\");\n                        // \"NOT\" can have just one child\n                        notIsEmpty = logical.hasClass(\"not\") &&\n                            logical.children(\".dropbox\").children(\"li\").length === 0;\n\n                        if (canHaveMultiple || notIsEmpty) {\n                            this.droppableParent = logical.children(\".dropbox\");\n                            break;\n                        }\n                    }\n                } else if (nestedRules.length === 0) {\n                    // \"NOT\" is empty\n                    this.droppableParent = rootLogical.children(\".dropbox\");\n                }\n            } else {\n                // root logical is either \"AND\" or \"OR\"\n                this.droppableParent = rootLogical.children(\".dropbox\");\n            }\n\n            if (this.droppableParent) {\n                this.setInactive(this.buttons.addCondition, false);\n                this.setInactive(this.buttons.addOperator, false);\n                this.$el.find(\".one-child-only:first\").hide();\n            } else {\n                this.setInactive(this.buttons.addCondition, true);\n                this.setInactive(this.buttons.addOperator, true);\n                this.$el.find(\".one-child-only:first\").show();\n            }\n        }\n    });\n});\n"]}