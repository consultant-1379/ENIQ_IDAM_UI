{"version":3,"sources":["../../../../../../../../../XUI/org/forgerock/openam/ui/user/uma/views/resource/MyLabelsPage.js"],"names":["define","$","Backbone","Backgrid","BackgridUtils","BasePage","BootstrapDialog","Configuration","Constants","EventManager","Router","UMAService","MyLabelsPage","extend","template","partials","events","deleteLabel","self","buttons","label","t","action","dialog","close","id","cssClass","enableButtons","getButton","text","labels","remove","data","_id","done","sendEvent","EVENT_DISPLAY_MESSAGE_REQUEST","routeTo","configuration","routes","umaResourcesMyResources","trigger","args","fail","show","type","TYPE_DANGER","title","message","closable","recordsPresent","$el","find","prop","render","callback","labelId","get","then","result","renderGrid","createLabelCollection","createColumns","parentRender"],"mappings":"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","file":"MyLabelsPage.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2015-2017 ForgeRock AS.\n */\n\ndefine([\n    \"jquery\",\n    \"backbone\",\n    \"org/forgerock/commons/ui/common/backgrid/Backgrid\",\n    \"org/forgerock/openam/ui/common/util/BackgridUtils\",\n    \"org/forgerock/openam/ui/user/uma/views/resource/BasePage\",\n    \"org/forgerock/commons/ui/common/components/BootstrapDialog\",\n    \"org/forgerock/commons/ui/common/main/Configuration\",\n    \"org/forgerock/commons/ui/common/util/Constants\",\n    \"org/forgerock/commons/ui/common/main/EventManager\",\n    \"org/forgerock/commons/ui/common/main/Router\",\n    \"org/forgerock/openam/ui/user/uma/services/UMAService\"\n], function ($, Backbone, Backgrid, BackgridUtils, BasePage, BootstrapDialog, Configuration, Constants, EventManager,\n             Router, UMAService) {\n    var MyLabelsPage = BasePage.extend({\n        template: \"templates/user/uma/views/resource/MyLabelsPageTemplate.html\",\n        partials: [\n            \"templates/user/uma/views/resource/_DeleteLabelButton.html\"\n        ],\n        events: {\n            \"click button#deleteLabel\": \"deleteLabel\"\n        },\n        deleteLabel () {\n            var self = this,\n                buttons = [{\n                    label: $.t(\"common.form.cancel\"),\n                    action (dialog) {\n                        dialog.close();\n                    }\n                }, {\n                    id: \"ok\",\n                    label: $.t(\"common.form.ok\"),\n                    cssClass: \"btn-primary btn-danger\",\n                    action (dialog) {\n                        dialog.enableButtons(false);\n                        dialog.getButton(\"ok\").text($.t(\"common.form.working\"));\n\n                        UMAService.labels.remove(self.data.label._id).done(function () {\n                            EventManager.sendEvent(Constants.EVENT_DISPLAY_MESSAGE_REQUEST, \"deleteLabelSuccess\");\n\n                            dialog.close();\n                            Router.routeTo(Router.configuration.routes.umaResourcesMyResources, {\n                                trigger: true,\n                                args: []\n                            });\n                        }).fail(function () {\n                            EventManager.sendEvent(Constants.EVENT_DISPLAY_MESSAGE_REQUEST, \"deleteLabelFail\");\n\n                            dialog.enableButtons(true);\n                            dialog.getButton(\"ok\").text($.t(\"common.form.ok\"));\n                        });\n                    }\n                }];\n\n            BootstrapDialog.show({\n                type: BootstrapDialog.TYPE_DANGER,\n                title: $.t(\"uma.resources.myLabels.deleteLabel.dialog.title\"),\n                message: $.t(\"uma.resources.myLabels.deleteLabel.dialog.message\"),\n                closable: false,\n                buttons\n            });\n        },\n        recordsPresent () {\n            this.$el.find(\"button#deleteLabel\").prop(\"disabled\", false);\n        },\n        render (args, callback) {\n            var labelId = args[0],\n                self = this;\n\n            UMAService.labels.get(labelId).then(function (result) {\n                self.data.label = result;\n                if (result) {\n                    self.renderGrid(self.createLabelCollection(labelId), self.createColumns(`mylabels/${labelId}`),\n                        callback);\n                } else {\n                    self.parentRender(callback);\n                }\n            });\n        }\n    });\n\n    return MyLabelsPage;\n});\n"]}