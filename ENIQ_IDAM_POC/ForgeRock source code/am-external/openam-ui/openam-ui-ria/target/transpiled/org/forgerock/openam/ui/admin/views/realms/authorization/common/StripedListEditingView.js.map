{"version":3,"sources":["../../../../../../../../../../XUI/org/forgerock/openam/ui/admin/views/realms/authorization/common/StripedListEditingView.js"],"names":["define","$","_","AbstractView","EventManager","Constants","extend","noBaseTemplate","events","baseRender","data","tpl","el","callback","options","template","element","renderParent","parentRender","justAdded","flashDomItem","$el","find","addItem","e","type","keyCode","toggleAddButton","isValid","pending","getPendingItem","duplicateIndex","counter","sendEvent","EVENT_DISPLAY_MESSAGE_REQUEST","each","items","item","isExistingItem","push","updateEntity","focus","deleteItem","getCollectionWithout","className","addClass","doTimeout","uniqueId","removeClass","enabled","prop"],"mappings":";;AAAA;;;;;;;;;;;;;;;;AAgBAA,OAAO,CACH,QADG,EAEH,QAFG,EAGH,mDAHG,EAIH,mDAJG,EAKH,gDALG,EAMH,WANG,CAAP,EAOG,UAACC,CAAD,EAAIC,CAAJ,EAAOC,YAAP,EAAqBC,YAArB,EAAmCC,SAAnC;AAAA,WACCF,aAAaG,MAAb,CAAoB;AAChBC,wBAAgB,IADA;AAEhBC,gBAAQ;AACJ,qCAAyB,SADrB;AAEJ,qCAAyB,SAFrB;AAGJ,0CAA8B,SAH1B;AAIJ,uCAA2B,YAJvB;AAKJ,uCAA2B;AALvB,SAFQ;;AAUhBC,kBAVgB,sBAUJC,IAVI,EAUEC,GAVF,EAUOC,EAVP,EAUWC,QAVX,EAUqB;AACjC,iBAAKH,IAAL,GAAYA,IAAZ;AACA,iBAAKA,IAAL,CAAUI,OAAV,GAAoB,EAApB;;AAEA,iBAAKC,QAAL,GAAgBJ,GAAhB;AACA,iBAAKK,OAAL,GAAeJ,EAAf;;AAEA,iBAAKK,YAAL,CAAkBJ,QAAlB;AACH,SAlBe;AAoBhBI,oBApBgB,wBAoBFJ,QApBE,EAoBQ;AACpB,iBAAKK,YAAL,CAAkB,YAAY;AAC1B,uBAAO,KAAKR,IAAL,CAAUI,OAAV,CAAkBK,SAAzB;;AAEA,qBAAKC,YAAL,CAAkB,KAAKC,GAAL,CAASC,IAAT,CAAc,eAAd,CAAlB,EAAkD,cAAlD;;AAEA,oBAAIT,QAAJ,EAAc;AACVA;AACH;AACJ,aARD;AASH,SA9Be;AAgChBU,eAhCgB,mBAgCPC,CAhCO,EAgCJ;AAAA;;AACR,gBAAIA,EAAEC,IAAF,KAAW,OAAX,IAAsBD,EAAEE,OAAF,KAAc,EAAxC,EAA4C;AACxC,qBAAKC,eAAL,CAAqB,KAAKC,OAAL,CAAaJ,CAAb,CAArB;AACA;AACH;;AAED,gBAAMK,UAAU,KAAKC,cAAL,CAAoBN,CAApB,CAAhB,CANQ,CAMgC;AACxC,gBAAIO,iBAAiB,CAAC,CAAtB;AACA,gBAAIC,UAAU,CAAd;;AAEA,gBAAI,CAAC,KAAKJ,OAAL,CAAaJ,CAAb,CAAL,EAAsB;AAAE;AACpBpB,6BAAa6B,SAAb,CAAuB5B,UAAU6B,6BAAjC,EAAgE,aAAhE;AACA,qBAAKd,YAAL,CAAkB,KAAKC,GAAL,CAASC,IAAT,CAAc,UAAd,CAAlB,EAA6C,aAA7C;AACA;AACH;;AAEDpB,cAAEiC,IAAF,CAAO,KAAKzB,IAAL,CAAU0B,KAAjB,EAAwB,UAACC,IAAD,EAAU;AAC9B,oBAAI,MAAKC,cAAL,CAAoBT,OAApB,EAA6BQ,IAA7B,CAAJ,EAAwC;AAAE;AACtCN,qCAAiBC,OAAjB;AACA;AACH;AACDA;AACH,aAND;;AAQA,gBAAID,kBAAkB,CAAtB,EAAyB;AACrB3B,6BAAa6B,SAAb,CAAuB5B,UAAU6B,6BAAjC,EAAgE,eAAhE;AACA,qBAAKd,YAAL,CAAkB,KAAKC,GAAL,CAASC,IAAT,0BAAqCS,cAArC,OAAlB,EAA2E,aAA3E;AACH,aAHD,MAGO;AACH,qBAAKrB,IAAL,CAAU0B,KAAV,CAAgBG,IAAhB,CAAqBV,OAArB;AACA,qBAAKnB,IAAL,CAAUI,OAAV,CAAkBK,SAAlB,GAA8BU,OAA9B;AACA,oBAAI,KAAKW,YAAT,EAAuB;AACnB;AACA,yBAAKA,YAAL;AACH;AACD,qBAAKvB,YAAL,CAAkB,YAAM;AACpB,0BAAKI,GAAL,CAASC,IAAT,CAAc,2BAAd,EAA2CmB,KAA3C;AACH,iBAFD;AAGH;AACJ,SAtEe;AAwEhBC,kBAxEgB,sBAwEJlB,CAxEI,EAwED;AACX,gBAAIA,EAAEC,IAAF,KAAW,OAAX,IAAsBD,EAAEE,OAAF,KAAc,EAAxC,EAA4C;AACxC;AACH;;AAED,iBAAKhB,IAAL,CAAU0B,KAAV,GAAkB,KAAKO,oBAAL,CAA0BnB,CAA1B,CAAlB,CALW,CAKqC;AAChD,gBAAI,KAAKgB,YAAT,EAAuB;AACnB,qBAAKA,YAAL,GADmB,CACE;AACxB;AACD,iBAAKvB,YAAL;AACH,SAlFe;AAoFhBG,oBApFgB,wBAoFFiB,IApFE,EAoFIO,SApFJ,EAoFe;AAC3BP,iBAAKQ,QAAL,CAAcD,SAAd;AACA3C,cAAE6C,SAAF,CAAY5C,EAAE6C,QAAF,CAAWH,SAAX,CAAZ,EAAmC,IAAnC,EAAyC,YAAY;AACjDP,qBAAKW,WAAL,CAAiBJ,SAAjB;AACH,aAFD;AAGH,SAzFe;AA2FhBjB,uBA3FgB,2BA2FCsB,OA3FD,EA2FU;AACtB,iBAAK5B,GAAL,CAASC,IAAT,CAAc,iBAAd,EAAiC4B,IAAjC,CAAsC,UAAtC,EAAkD,CAACD,OAAnD;AACH;AA7Fe,KAApB,CADD;AAAA,CAPH","file":"StripedListEditingView.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2015-2017 ForgeRock AS.\n */\n\ndefine([\n    \"jquery\",\n    \"lodash\",\n    \"org/forgerock/commons/ui/common/main/AbstractView\",\n    \"org/forgerock/commons/ui/common/main/EventManager\",\n    \"org/forgerock/commons/ui/common/util/Constants\",\n    \"doTimeout\"\n], ($, _, AbstractView, EventManager, Constants) =>\n    AbstractView.extend({\n        noBaseTemplate: true,\n        events: {\n            \"click [data-add-item]\": \"addItem\",\n            \"keyup [data-add-item]\": \"addItem\",\n            \"keyup [data-editing-input]\": \"addItem\",\n            \"click span[data-delete]\": \"deleteItem\",\n            \"keyup span[data-delete]\": \"deleteItem\"\n        },\n\n        baseRender (data, tpl, el, callback) {\n            this.data = data;\n            this.data.options = {};\n\n            this.template = tpl;\n            this.element = el;\n\n            this.renderParent(callback);\n        },\n\n        renderParent (callback) {\n            this.parentRender(function () {\n                delete this.data.options.justAdded;\n\n                this.flashDomItem(this.$el.find(\".text-success\"), \"text-success\");\n\n                if (callback) {\n                    callback();\n                }\n            });\n        },\n\n        addItem (e) {\n            if (e.type === \"keyup\" && e.keyCode !== 13) {\n                this.toggleAddButton(this.isValid(e));\n                return;\n            }\n\n            const pending = this.getPendingItem(e); // provide child implementation\n            let duplicateIndex = -1;\n            let counter = 0;\n\n            if (!this.isValid(e)) { // provide child implementation\n                EventManager.sendEvent(Constants.EVENT_DISPLAY_MESSAGE_REQUEST, \"invalidItem\");\n                this.flashDomItem(this.$el.find(\".editing\"), \"text-danger\");\n                return;\n            }\n\n            _.each(this.data.items, (item) => {\n                if (this.isExistingItem(pending, item)) { // provide child implementation\n                    duplicateIndex = counter;\n                    return;\n                }\n                counter++;\n            });\n\n            if (duplicateIndex >= 0) {\n                EventManager.sendEvent(Constants.EVENT_DISPLAY_MESSAGE_REQUEST, \"duplicateItem\");\n                this.flashDomItem(this.$el.find(`.list-group-item:eq(${duplicateIndex})`), \"text-danger\");\n            } else {\n                this.data.items.push(pending);\n                this.data.options.justAdded = pending;\n                if (this.updateEntity) {\n                    // provide child implementation\n                    this.updateEntity();\n                }\n                this.renderParent(() => {\n                    this.$el.find(\".editing input[type=text]\").focus();\n                });\n            }\n        },\n\n        deleteItem (e) {\n            if (e.type === \"keyup\" && e.keyCode !== 13) {\n                return;\n            }\n\n            this.data.items = this.getCollectionWithout(e); // provide child implementation\n            if (this.updateEntity) {\n                this.updateEntity(); // provide child implementation\n            }\n            this.renderParent();\n        },\n\n        flashDomItem (item, className) {\n            item.addClass(className);\n            $.doTimeout(_.uniqueId(className), 2000, function () {\n                item.removeClass(className);\n            });\n        },\n\n        toggleAddButton (enabled) {\n            this.$el.find(\"[data-add-item]\").prop(\"disabled\", !enabled);\n        }\n    })\n);\n"]}