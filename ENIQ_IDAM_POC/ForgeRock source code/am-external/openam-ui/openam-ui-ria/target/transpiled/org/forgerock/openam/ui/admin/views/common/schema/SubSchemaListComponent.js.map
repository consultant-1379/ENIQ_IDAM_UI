{"version":3,"sources":["../../../../../../../../../XUI/org/forgerock/openam/ui/admin/views/common/schema/SubSchemaListComponent.js"],"names":["define","$","_","Backbone","Messages","EventManager","Constants","UIUtils","FormHelper","Promise","View","extend","events","initialize","data","subSchemaTemplate","getSubSchemaCreatableTypes","getSubSchemaInstances","deleteSubSchemaInstance","render","all","then","response","fillTemplateWithData","assign","instances","creatables","showDeleteButton","serviceType","html","$el","onDelete","event","preventDefault","target","currentTarget","subSchemaInstance","closest","subSchemaType","showConfirmationBeforeDeleting","message","t","sendEvent","EVENT_DISPLAY_MESSAGE_REQUEST","addMessage","type","TYPE_DANGER"],"mappings":";;AAAA;;;;;;;;;;;;;;;;AAgBA;;;AAGAA,OAAO,0EAAP,EAAmF,CAC/E,QAD+E,EAE/E,QAF+E,EAG/E,UAH+E,EAI/E,qDAJ+E,EAK/E,mDAL+E,EAM/E,gDAN+E,EAO/E,8CAP+E,EAQ/E,gDAR+E,EAS/E,6CAT+E,CAAnF,EAUG,UAACC,CAAD,EAAIC,CAAJ,EAAOC,QAAP,EAAiBC,QAAjB,EAA2BC,YAA3B,EAAyCC,SAAzC,EAAoDC,OAApD,EAA6DC,UAA7D,EAAyEC,OAAzE;AAAA,WAAqFN,SAASO,IAAT,CAAcC,MAAd,CAAqB;AACzGC,gBAAQ;AACJ,6CAAkC;AAD9B,SADiG;;AAKzGC,kBALyG,4BAWtG;AAAA,gBALCC,IAKD,QALCA,IAKD;AAAA,gBAJCC,iBAID,QAJCA,iBAID;AAAA,gBAHCC,0BAGD,QAHCA,0BAGD;AAAA,gBAFCC,qBAED,QAFCA,qBAED;AAAA,gBADCC,uBACD,QADCA,uBACD;;AACC,iBAAKJ,IAAL,GAAYA,IAAZ;AACA,iBAAKC,iBAAL,GAAyBA,iBAAzB;AACA,iBAAKC,0BAAL,GAAkCA,0BAAlC;AACA,iBAAKC,qBAAL,GAA6BA,qBAA7B;AACA,iBAAKC,uBAAL,GAA+BA,uBAA/B;AACH,SAjBwG;AAmBzGC,cAnByG,oBAmB/F;AAAA;;AACNV,oBAAQW,GAAR,CAAY,CAAC,KAAKH,qBAAL,EAAD,EAA+B,KAAKD,0BAAL,EAA/B,CAAZ,EAA+EK,IAA/E,CAAoF,UAACC,QAAD,EAAc;AAC9Ff,wBAAQgB,oBAAR,CAA6B,MAAKR,iBAAlC,EAAqDb,EAAEsB,MAAF,CAAS,MAAKV,IAAd,EAAoB;AACrEW,+BAAWH,SAAS,CAAT,CAD0D;AAErEI,gCAAYJ,SAAS,CAAT,CAFyD;AAGrE;AACAK,sCAAkB,MAAKb,IAAL,CAAUc,WAAV,KAA0B;AAJyB,iBAApB,CAArD,EAKI,UAACC,IAAD,EAAU;AACV,0BAAKC,GAAL,CAASD,IAAT,CAAcA,IAAd;AACH,iBAPD;AAQH,aATD;;AAWA,mBAAO,IAAP;AACH,SAhCwG;AAkCzGE,gBAlCyG,oBAkC/FC,KAlC+F,EAkCxF;AAAA;;AACbA,kBAAMC,cAAN;;AAEA,gBAAMC,SAASjC,EAAE+B,MAAMG,aAAR,CAAf;AACA,gBAAMC,oBAAoBF,OAAOG,OAAP,CAAe,IAAf,EAAqBvB,IAArB,CAA0B,aAA1B,CAA1B;AACA,gBAAMwB,gBAAgBJ,OAAOG,OAAP,CAAe,IAAf,EAAqBvB,IAArB,CAA0B,eAA1B,CAAtB;;AAEAN,uBAAW+B,8BAAX,CAA0C;AACtCC,yBAASvC,EAAEwC,CAAF,CAAI,sCAAJ;AAD6B,aAA1C,EAEG,YAAM;AACL,uBAAKvB,uBAAL,CAA6BoB,aAA7B,EAA4CF,iBAA5C,EAA+Df,IAA/D,CAAoE,YAAM;AACtEhB,iCAAaqC,SAAb,CAAuBpC,UAAUqC,6BAAjC,EAAgE,cAAhE;AACA,2BAAKxB,MAAL;AACH,iBAHD,EAIA,UAACG,QAAD;AAAA,2BAAclB,SAASwC,UAAT,CAAoB,EAAEtB,kBAAF,EAAYuB,MAAMzC,SAAS0C,WAA3B,EAApB,CAAd;AAAA,iBAJA;AAKH,aARD;AASH;AAlDwG,KAArB,CAArF;AAAA,CAVH","file":"SubSchemaListComponent.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2016-2017 ForgeRock AS.\n */\n\n/**\n  * @module org/forgerock/openam/ui/admin/views/common/schema/SubSchemaListComponent\n  */\ndefine(\"org/forgerock/openam/ui/admin/views/common/schema/SubSchemaListComponent\", [\n    \"jquery\",\n    \"lodash\",\n    \"backbone\",\n    \"org/forgerock/commons/ui/common/components/Messages\",\n    \"org/forgerock/commons/ui/common/main/EventManager\",\n    \"org/forgerock/commons/ui/common/util/Constants\",\n    \"org/forgerock/commons/ui/common/util/UIUtils\",\n    \"org/forgerock/openam/ui/admin/utils/FormHelper\",\n    \"org/forgerock/openam/ui/common/util/Promise\"\n], ($, _, Backbone, Messages, EventManager, Constants, UIUtils, FormHelper, Promise) => Backbone.View.extend({\n    events: {\n        \"click [data-subschema-delete]\" : \"onDelete\"\n    },\n\n    initialize ({\n        data,\n        subSchemaTemplate,\n        getSubSchemaCreatableTypes,\n        getSubSchemaInstances,\n        deleteSubSchemaInstance\n    }) {\n        this.data = data;\n        this.subSchemaTemplate = subSchemaTemplate;\n        this.getSubSchemaCreatableTypes = getSubSchemaCreatableTypes;\n        this.getSubSchemaInstances = getSubSchemaInstances;\n        this.deleteSubSchemaInstance = deleteSubSchemaInstance;\n    },\n\n    render () {\n        Promise.all([this.getSubSchemaInstances(), this.getSubSchemaCreatableTypes()]).then((response) => {\n            UIUtils.fillTemplateWithData(this.subSchemaTemplate, _.assign(this.data, {\n                instances: response[0],\n                creatables: response[1],\n                // scripting sub configuration (default types) can't be deleted\n                showDeleteButton: this.data.serviceType !== \"scripting\"\n            }), (html) => {\n                this.$el.html(html);\n            });\n        });\n\n        return this;\n    },\n\n    onDelete (event) {\n        event.preventDefault();\n\n        const target = $(event.currentTarget);\n        const subSchemaInstance = target.closest(\"tr\").data(\"subschemaId\");\n        const subSchemaType = target.closest(\"tr\").data(\"subschemaType\");\n\n        FormHelper.showConfirmationBeforeDeleting({\n            message: $.t(\"console.common.confirmDeleteSelected\")\n        }, () => {\n            this.deleteSubSchemaInstance(subSchemaType, subSchemaInstance).then(() => {\n                EventManager.sendEvent(Constants.EVENT_DISPLAY_MESSAGE_REQUEST, \"changesSaved\");\n                this.render();\n            },\n            (response) => Messages.addMessage({ response, type: Messages.TYPE_DANGER }));\n        });\n    }\n}));\n"]}