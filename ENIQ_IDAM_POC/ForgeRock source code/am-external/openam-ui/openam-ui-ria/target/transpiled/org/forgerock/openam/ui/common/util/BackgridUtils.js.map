{"version":3,"sources":["../../../../../../../XUI/org/forgerock/openam/ui/common/util/BackgridUtils.js"],"names":["define","$","_","Backbone","moment","Backgrid","ThemeableServerSideFilter","Messages","Router","UIUtils","obj","DatetimeAgoCell","Cell","extend","className","formatter","fromRaw","rawData","fromNow","render","__super__","apply","$el","attr","model","get","column","format","ArrayCell","buildHtml","arrayVal","result","i","length","isString","JSON","stringify","empty","attributes","name","append","delegateEvents","ObjectCell","object","prop","UniversalIdToUsername","substring","indexOf","ClickableRow","Row","events","onKeyup","e","keyCode","callback","onClick","TemplateCell","self","fillTemplateWithData","template","content","html","rendered","ClassHeaderCell","HeaderCell","UriExtCell","UriCell","rawValue","formattedValue","href","isFunction","title","text","data","gotoUrl","preventDefault","currentTarget","navigate","trigger","FilterHeaderCell","filter","Extension","placeholder","t","collection","addClassName","addClass","state","filters","push","prepend","el","queryFilter","undefined","params","additionalFilters","_queryFilter","getFilter","filterName","filterQuery","encodeURIComponent","each","query","concat","join","parseState","resp","totalRecords","remainingPagedResults","resultCount","totalPages","Math","ceil","pageSize","pagedResultsOffset","currentPage","sortKeys","order","sortKey","sync","method","options","includeList","_queryId","forIn","val","key","include","processData","beforeSend","xhr","setRequestHeader","error","response","addMessage","type","TYPE_DANGER","parseRecords","getQueryParams","_sortKeys","call","_pagedResultsOffset","doubleSortFix","cid","filtered","set","getState"],"mappings":"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","file":"BackgridUtils.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2015-2017 ForgeRock AS.\n */\n\ndefine([\n    \"jquery\",\n    \"lodash\",\n    \"backbone\",\n    \"moment\",\n    \"org/forgerock/commons/ui/common/backgrid/Backgrid\",\n    \"org/forgerock/commons/ui/common/backgrid/extension/ThemeableServerSideFilter\",\n    \"org/forgerock/commons/ui/common/components/Messages\",\n    \"org/forgerock/commons/ui/common/main/Router\",\n    \"org/forgerock/commons/ui/common/util/UIUtils\"\n], function ($, _, Backbone, moment, Backgrid, ThemeableServerSideFilter, Messages, Router, UIUtils) {\n    /**\n     * @exports org/forgerock/openam/ui/common/util/BackgridUtils\n     */\n    var obj = {};\n\n    /**\n     * Datetime Ago Cell Renderer\n     * <p>\n     * Displays human friendly date time text (e.g. 4 \"hours ago\") with a tooltip of the exact time\n     */\n    obj.DatetimeAgoCell = Backgrid.Cell.extend({\n        className: \"date-time-ago-cell\",\n        formatter: {\n            fromRaw (rawData) {\n                return moment(rawData).fromNow();\n            }\n        },\n        render () {\n            obj.DatetimeAgoCell.__super__.render.apply(this);\n            this.$el.attr(\"title\", moment(this.model.get(this.column.get(\"name\"))).format(\"Do MMMM YYYY, h:mm:ssa\"));\n            return this;\n        }\n    });\n\n    /**\n     * Array Cell\n     * <p>\n     * Displays cell content as an unordered list. Used for cells which values are arrays\n     */\n    obj.ArrayCell = Backgrid.Cell.extend({\n        className: \"array-formatter-cell\",\n\n        buildHtml (arrayVal) {\n            var result = \"<ul>\",\n                i = 0;\n\n            for (; i < arrayVal.length; i++) {\n                if (_.isString(arrayVal[i])) {\n                    result += `<li>${arrayVal[i]}</li>`;\n                } else {\n                    result += `<li>${JSON.stringify(arrayVal[i])}</li>`;\n                }\n            }\n            result += \"</ul>\";\n\n            return result;\n        },\n\n        render () {\n            this.$el.empty();\n\n            var arrayVal = this.model.get(this.column.attributes.name);\n            this.$el.append(this.buildHtml(arrayVal));\n\n            this.delegateEvents();\n            return this;\n        }\n    });\n\n    /**\n     * Object Cell\n     * <p>\n     * Displays cell content as a definition list. Used for cells which values are objects\n     */\n    obj.ObjectCell = Backgrid.Cell.extend({\n        className: \"object-formatter-cell\",\n\n        render () {\n            this.$el.empty();\n\n            var object = this.model.get(this.column.attributes.name),\n                result = '<dl class=\"dl-horizontal\">',\n                prop;\n\n            for (prop in object) {\n                if (_.isString(object[prop])) {\n                    result += `<dt>${prop}</dt><dd>${object[prop]}</dd>`;\n                } else {\n                    result += `<dt>${prop}</dt><dd>${JSON.stringify(object[prop])}</dd>`;\n                }\n            }\n            result += \"</dl>\";\n\n            this.$el.append(result);\n\n            this.delegateEvents();\n            return this;\n        }\n    });\n\n    obj.UniversalIdToUsername = Backgrid.Cell.extend({\n        formatter: {\n            fromRaw (rawData) {\n                return rawData.substring(3, rawData.indexOf(\",ou=user\"));\n            }\n        },\n        render () {\n            obj.UniversalIdToUsername.__super__.render.apply(this);\n            this.$el.attr(\"title\", this.model.get(this.column.get(\"name\")));\n            return this;\n        }\n    });\n\n    /**\n     * Clickable Row\n     * <p>\n     * You must extend this row and specify a \"callback\" attribute e.g.\n     * <p>\n     * MyRow = BackgridUtils.ClickableRow.extend({\n     *     callback: myCallback\n     * });\n     */\n    obj.ClickableRow = Backgrid.Row.extend({\n        events: {\n            \"click\": \"onClick\",\n            \"keyup\": \"onKeyup\"\n        },\n\n        onKeyup (e) {\n            if (e.keyCode === 13 && this.callback) {\n                this.callback(e);\n            }\n        },\n\n        onClick (e) {\n            if (this.callback) {\n                this.callback(e);\n            }\n        }\n    });\n\n    /**\n     * Handlebars Template Cell Renderer\n     * <p>\n     * You must extend this renderer and specify a \"template\" attribute e.g.\n     * <p>\n     * MyCell = backgridUtils.TemplateCell.extend({\n     *     template: \"templates/MyTemplate.html\"\n     * });\n     */\n    obj.TemplateCell = Backgrid.Cell.extend({\n        className: \"template-cell\",\n        render () {\n            var self = this;\n\n            UIUtils.fillTemplateWithData(this.template, this.model, function (content) {\n                self.$el.html(content);\n                if (self.rendered) {\n                    self.rendered();\n                }\n\n                self.delegateEvents();\n            });\n\n            return this;\n        }\n    });\n\n    obj.ClassHeaderCell = Backgrid.HeaderCell.extend({\n        className: \"\",\n        render () {\n            obj.ClassHeaderCell.__super__.render.apply(this);\n            this.delegateEvents();\n            return this;\n        }\n    });\n\n    obj.UriExtCell = Backgrid.UriCell.extend({\n        events: {\n            \"click\": \"gotoUrl\"\n        },\n        render () {\n            this.$el.empty();\n            var rawValue = this.model.get(this.column.get(\"name\")),\n                formattedValue = this.formatter.fromRaw(rawValue, this.model),\n                href = _.isFunction(this.column.get(\"href\"))\n                    ? this.column.get(\"href\")(rawValue, formattedValue, this.model) : this.column.get(\"href\");\n\n            this.$el.append($(\"<a>\", {\n                href: href || rawValue,\n                title: this.title || formattedValue\n            }).text(formattedValue));\n\n            if (href) {\n                this.$el.data(\"href\", href);\n                this.$el.prop(\"title\", this.title || formattedValue);\n            }\n\n            this.delegateEvents();\n            return this;\n        },\n\n        gotoUrl (e) {\n            e.preventDefault();\n            var href = $(e.currentTarget).data(\"href\");\n            Router.navigate(href, { trigger: true });\n        }\n\n    });\n\n    obj.FilterHeaderCell = Backgrid.HeaderCell.extend({\n        className: \"filter-header-cell enable-pointer\",\n        render () {\n            var filter = new Backgrid.Extension.ThemeableServerSideFilter({\n                name: this.column.get(\"name\"),\n                placeholder: $.t(\"common.form.filter\"),\n                collection: this.collection\n            });\n\n            if (this.addClassName) {\n                this.$el.addClass(this.addClassName);\n            }\n\n            this.collection.state.filters = this.collection.state.filters ? this.collection.state.filters : [];\n            this.collection.state.filters.push(filter);\n            obj.FilterHeaderCell.__super__.render.apply(this);\n            this.$el.prepend(filter.render().el);\n            return this;\n        }\n    });\n\n    obj.queryFilter = function (data) {\n        if (data === undefined) { data = {}; }\n\n        var params = [],\n            additionalFilters = data._queryFilter || [],\n            getFilter = (function () {\n                return data && data.filterName && data.filterName === \"eq\"\n                    ? function (filterName, filterQuery) {\n                        // Policies endpoints do not support 'co', so we emulate it using 'eq' and wildcards\n                        return `${filterName}+eq+${encodeURIComponent(`\"*${filterQuery}*\"`)}`;\n                    }\n                    : function (filterName, filterQuery) {\n                        return `${filterName}+co+${encodeURIComponent(`\"${filterQuery}\"`)}`;\n                    };\n            }());\n\n        _.each(this.state.filters, function (filter) {\n            if (filter.query() !== \"\") {\n                params.push(getFilter(filter.name, filter.query()));\n            }\n        });\n        params = params.concat(additionalFilters);\n\n        return params.length === 0 ? true : params.join(\"+AND+\");\n    };\n\n    obj.parseState = function (resp) {\n        if (!this.state.totalRecords) {\n            this.state.totalRecords = resp.remainingPagedResults + resp.resultCount;\n        }\n        if (!this.state.totalPages) {\n            this.state.totalPages = Math.ceil(this.state.totalRecords / this.state.pageSize);\n        }\n        return this.state;\n    };\n\n    obj.pagedResultsOffset = function () {\n        return (this.state.currentPage - 1) * this.state.pageSize;\n    };\n\n    obj.sortKeys = function () {\n        return this.state.order === 1 ? `-${this.state.sortKey}` : this.state.sortKey;\n    };\n\n    obj.sync = function (method, model, options) {\n        var params = [],\n            includeList = [\"_pageSize\", \"_pagedResultsOffset\", \"_sortKeys\"];\n\n        // TODO: UMA: Workaround as resource set end point requires a _queryId=* to indicate a blank query,\n        // while the historyAudit end point requires a _queryFilter=true to indicate a blank query.\n        if (options.data._queryId === \"*\" && options.data._queryFilter === true) {\n            includeList.push(\"_queryId\");\n        } else {\n            includeList.push(\"_queryFilter\");\n        }\n\n        _.forIn(options.data, function (val, key) {\n            if (_.include(includeList, key)) {\n                params.push(`${key}=${val}`);\n            }\n        });\n\n        options.data = params.join(\"&\");\n        options.processData = false;\n\n        if (!options.beforeSend) {\n            options.beforeSend = function (xhr) {\n                xhr.setRequestHeader(\"Accept-API-Version\", \"protocol=1.0,resource=1.0\");\n            };\n        }\n\n        options.error = function (response) {\n            Messages.addMessage({\n                type: Messages.TYPE_DANGER,\n                response\n            });\n        };\n\n        return Backbone.sync(method, model, options);\n    };\n\n    obj.parseRecords = function (data) {\n        return data.result;\n    };\n\n    obj.getQueryParams = function (data) {\n        data = data || {};\n\n        return {\n            _sortKeys: this.sortKeys,\n            _queryFilter () {\n                return obj.queryFilter.call(this, data);\n            },\n            pageSize: \"_pageSize\",\n            _pagedResultsOffset: this.pagedResultsOffset\n        };\n    };\n\n    // FIXME: Workaround to fix \"Double sort indicators\" issue\n    // @see https://github.com/wyuenho/backgrid/issues/453\n    obj.doubleSortFix = function (model) {\n        // No ids so identify model with CID\n        var cid = model.cid,\n            filtered = model.collection.filter(function (model) {\n                return model.cid !== cid;\n            });\n\n        _.each(filtered, function (model) {\n            model.set(\"direction\", null);\n        });\n    };\n\n    obj.getState = function (data) {\n        var state = {\n            pageSize: 20,\n            sortKey: \"name\"\n        };\n\n        if (data && typeof data === \"object\") {\n            _.extend(state, data);\n        }\n        return state;\n    };\n\n    return obj;\n});\n"]}