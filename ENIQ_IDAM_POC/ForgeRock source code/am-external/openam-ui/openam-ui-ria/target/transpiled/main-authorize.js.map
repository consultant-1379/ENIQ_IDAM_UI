{"version":3,"sources":["../XUI/main-authorize.js"],"names":["require","config","map","paths","shim","exports","deps","$","_","HandleBars","Configuration","Constants","i18nManager","ThemeManager","window","formTemplate","baseTemplate","footerTemplate","loginHeaderTemplate","templatePaths","data","pageData","KEY_CODE_ENTER","KEY_CODE_SPACE","init","serverLang","paramLang","locale","defaultLang","DEFAULT_LANGUAGE","nameSpace","oauth2Data","each","displayScopes","obj","isEmpty","values","displayClaims","noScopes","globalData","realm","getTheme","always","theme","themePath","path","templatePath","AuthorizeTemplate","LoginBaseTemplate","FooterTemplate","LoginHeaderTemplate","compile","html","find","bind","e","type","keyCode","toggleClass","next","slideToggle"],"mappings":"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","file":"main-authorize.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2014-2017 ForgeRock AS.\n */\n\nrequire.config({\n    map: {\n        \"*\" : {\n            \"ThemeManager\" : \"org/forgerock/openam/ui/common/util/ThemeManager\",\n            \"Router\": \"org/forgerock/openam/ui/common/SingleRouteRouter\",\n            // TODO: Remove this when there are no longer any references to the \"underscore\" dependency\n            \"underscore\"   : \"lodash\"\n        }\n    },\n    paths: {\n        \"handlebars\": \"libs/handlebars-4.0.5\",\n        \"i18next\": \"libs/i18next-1.7.3-min\",\n        \"jquery\": \"libs/jquery-2.1.1-min\",\n        \"lodash\": \"libs/lodash-3.10.1-min\",\n        \"redux\": \"libs/redux-3.5.2-min\",\n        \"redux-actions\": \"libs/redux-actions-2.0.1-min\",\n        \"text\": \"libs/text-2.0.15\"\n    },\n    shim: {\n        \"handlebars\": {\n            exports: \"handlebars\"\n        },\n        \"i18next\": {\n            deps: [\"jquery\", \"handlebars\"],\n            exports: \"i18n\"\n        },\n        \"lodash\": {\n            exports: \"_\"\n        }\n    }\n});\n\nrequire([\n    \"jquery\",\n    \"lodash\",\n    \"handlebars\",\n    \"org/forgerock/commons/ui/common/main/Configuration\",\n    \"org/forgerock/openam/ui/common/util/Constants\",\n    \"org/forgerock/commons/ui/common/main/i18nManager\",\n    \"ThemeManager\"\n], function ($, _, HandleBars, Configuration, Constants, i18nManager, ThemeManager) {\n    // Helpers for the code that hasn't been properly migrated to require these as explicit dependencies:\n    window.$ = $;\n    window._ = _;\n\n    var formTemplate,\n        baseTemplate,\n        footerTemplate,\n        loginHeaderTemplate,\n        templatePaths = [\n            \"templates/user/AuthorizeTemplate.html\",\n            \"templates/common/LoginBaseTemplate.html\",\n            \"templates/common/FooterTemplate.html\",\n            \"templates/common/LoginHeaderTemplate.html\"\n        ],\n        data = window.pageData || {},\n        KEY_CODE_ENTER = 13,\n        KEY_CODE_SPACE = 32;\n\n    i18nManager.init({\n        serverLang: data.serverLang,\n        paramLang: {\n            locale: data.locale\n        },\n        defaultLang: Constants.DEFAULT_LANGUAGE,\n        nameSpace: \"authorize\"\n    });\n\n    if (data.oauth2Data) {\n        _.each(data.oauth2Data.displayScopes, function (obj) {\n            if (_.isEmpty(obj.values)) {\n                delete obj.values;\n            }\n            return obj;\n        });\n\n        _.each(data.oauth2Data.displayClaims, function (obj) {\n            if (_.isEmpty(obj.values)) {\n                delete obj.values;\n            }\n            return obj;\n        });\n\n        if (_.isEmpty(data.oauth2Data.displayScopes) && _.isEmpty(data.oauth2Data.displayClaims)) {\n            data.noScopes = true;\n        }\n    } else {\n        data.noScopes = true;\n    }\n\n    Configuration.globalData = { realm : data.realm };\n\n    ThemeManager.getTheme().always(function (theme) {\n        // add prefix to templates for custom theme when path is defined\n        var themePath = Configuration.globalData.theme.path;\n        templatePaths = _.map(templatePaths, function (templatePath) {\n            return `text!${themePath}${templatePath}`;\n        });\n\n        require(templatePaths, function (AuthorizeTemplate, LoginBaseTemplate, FooterTemplate, LoginHeaderTemplate) {\n            data.theme = theme;\n            baseTemplate = HandleBars.compile(LoginBaseTemplate);\n            formTemplate = HandleBars.compile(AuthorizeTemplate);\n            footerTemplate = HandleBars.compile(FooterTemplate);\n            loginHeaderTemplate = HandleBars.compile(LoginHeaderTemplate);\n\n            $(\"#wrapper\").html(baseTemplate(data));\n            $(\"#footer\").html(footerTemplate(data));\n            $(\"#loginBaseLogo\").html(loginHeaderTemplate(data));\n            $(\"#content\").html(formTemplate(data)).find(\".panel-heading\").bind(\"click keyup\", function (e) {\n                // keyup is required so that the collapsed panel can be opened with the keyboard alone,\n                // and without relying on a mouse click event.\n                if (e.type === \"keyup\" && e.keyCode !== KEY_CODE_ENTER && e.keyCode !== KEY_CODE_SPACE) {\n                    return;\n                }\n                $(this).toggleClass(\"expanded\").next(\".panel-collapse\").slideToggle();\n            });\n        });\n    });\n});\n"]}