{"version":3,"sources":["../../../../../../../../XUI/org/forgerock/openam/ui/admin/models/authorization/PolicySetModel.js"],"names":["define","_","Backbone","URLHelper","ModelUtils","Model","extend","idAttribute","urlRoot","substitute","defaults","name","displayName","description","resourceTypeUuids","realm","parse","response","isEmpty","validate","attrs","trim","indexOf","sync","method","model","options","beforeSend","xhr","setRequestHeader","error","errorHandler","id","url","prototype","call"],"mappings":";;AAAA;;;;;;;;;;;;;;;;AAgBAA,OAAO,CACH,QADG,EAEH,UAFG,EAGH,+CAHG,EAIH,gDAJG,CAAP,EAKG,UAAUC,CAAV,EAAaC,QAAb,EAAuBC,SAAvB,EAAkCC,UAAlC,EAA8C;AAC7C,WAAOF,SAASG,KAAT,CAAeC,MAAf,CAAsB;AACzBC,qBAAa,MADY;AAEzBC,iBAASL,UAAUM,UAAV,CAAqB,sBAArB,CAFgB;;AAIzBC,gBAJyB,sBAIb;AACR,mBAAO;AACHC,sBAAM,IADH;AAEHC,6BAAa,IAFV;AAGHC,6BAAa,EAHV;AAIHC,mCAAmB,EAJhB;AAKHC,uBAAO;AALJ,aAAP;AAOH,SAZwB;AAczBC,aAdyB,iBAclBC,QAdkB,EAcR;AACb,gBAAIhB,EAAEiB,OAAF,CAAUD,SAASL,WAAnB,CAAJ,EAAqC;AACjC,qBAAKA,WAAL,GAAmBK,SAASN,IAA5B;AACH,aAFD,MAEO;AACH,qBAAKC,WAAL,GAAmBK,SAASL,WAA5B;AACH;;AAED,mBAAOK,QAAP;AACH,SAtBwB;AAwBzBE,gBAxByB,oBAwBfC,KAxBe,EAwBR;AACb,gBAAIA,MAAMT,IAAN,CAAWU,IAAX,OAAsB,EAA1B,EAA8B;AAC1B,uBAAO,WAAP;AACH;;AAED;AACA,gBAAID,MAAMT,IAAN,CAAWW,OAAX,CAAmB,GAAnB,MAA4B,CAAhC,EAAmC;AAC/B,uBAAO,wBAAP;AACH;;AAED,gBAAIrB,EAAEiB,OAAF,CAAUE,MAAMN,iBAAhB,CAAJ,EAAwC;AACpC,uBAAO,iCAAP;AACH;AACJ,SArCwB;AAuCzBS,YAvCyB,gBAuCnBC,MAvCmB,EAuCXC,KAvCW,EAuCJC,OAvCI,EAuCK;AAC1BA,sBAAUA,WAAW,EAArB;AACAA,oBAAQC,UAAR,GAAqB,UAAUC,GAAV,EAAe;AAChCA,oBAAIC,gBAAJ,CAAqB,oBAArB,EAA2C,2BAA3C;AACH,aAFD;AAGAH,oBAAQI,KAAR,GAAgB1B,WAAW2B,YAA3B;;AAEA,gBAAIN,MAAMO,EAAN,KAAa,IAAjB,EAAuB;AACnBR,yBAAS,QAAT;AACAE,wBAAQO,GAAR,GAAiB,KAAKzB,OAAL,EAAjB;AACH;;AAED,mBAAON,SAASG,KAAT,CAAe6B,SAAf,CAAyBX,IAAzB,CAA8BY,IAA9B,CAAmC,IAAnC,EAAyCX,MAAzC,EAAiDC,KAAjD,EAAwDC,OAAxD,CAAP;AACH;AApDwB,KAAtB,CAAP;AAsDH,CA5DD","file":"PolicySetModel.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2015-2017 ForgeRock AS.\n */\n\ndefine([\n    \"lodash\",\n    \"backbone\",\n    \"org/forgerock/openam/ui/common/util/URLHelper\",\n    \"org/forgerock/openam/ui/admin/utils/ModelUtils\"\n], function (_, Backbone, URLHelper, ModelUtils) {\n    return Backbone.Model.extend({\n        idAttribute: \"name\",\n        urlRoot: URLHelper.substitute(\"__api__/applications\"),\n\n        defaults () {\n            return {\n                name: null,\n                displayName: null,\n                description: \"\",\n                resourceTypeUuids: [],\n                realm: \"\"\n            };\n        },\n\n        parse (response) {\n            if (_.isEmpty(response.displayName)) {\n                this.displayName = response.name;\n            } else {\n                this.displayName = response.displayName;\n            }\n\n            return response;\n        },\n\n        validate (attrs) {\n            if (attrs.name.trim() === \"\") {\n                return \"errorNoId\";\n            }\n\n            // entities that are stored in LDAP can't start with '#'. http://www.jguru.com/faq/view.jsp?EID=113588\n            if (attrs.name.indexOf(\"#\") === 0) {\n                return \"errorCantStartWithHash\";\n            }\n\n            if (_.isEmpty(attrs.resourceTypeUuids)) {\n                return \"applicationErrorNoResourceTypes\";\n            }\n        },\n\n        sync (method, model, options) {\n            options = options || {};\n            options.beforeSend = function (xhr) {\n                xhr.setRequestHeader(\"Accept-API-Version\", \"protocol=1.0,resource=2.0\");\n            };\n            options.error = ModelUtils.errorHandler;\n\n            if (model.id === null) {\n                method = \"create\";\n                options.url = `${this.urlRoot()}/?_action=create`;\n            }\n\n            return Backbone.Model.prototype.sync.call(this, method, model, options);\n        }\n    });\n});\n"]}