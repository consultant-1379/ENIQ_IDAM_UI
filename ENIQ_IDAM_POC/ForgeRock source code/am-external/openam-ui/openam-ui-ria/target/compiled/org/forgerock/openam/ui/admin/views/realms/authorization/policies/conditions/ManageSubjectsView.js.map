{"version":3,"sources":["../../../../../../../../../../../XUI/org/forgerock/openam/ui/admin/views/realms/authorization/policies/conditions/ManageSubjectsView.js"],"names":["define","$","_","ManageRulesView","Constants","ManageSubjectsView","extend","element","subEvents","data","buttons","idCount","typeAND","render","args","callback","idPrefix","property","properties","conditionName","t","entity","options","subjects","operators","self","each","availableSubjects","item","logical","push","config","type","find","title","init","conditionType","SUBJECT","setElement","parentRender","addCondition","$el","addOperator","length","hide","buildList","initSorting","identifyDroppableLogical"],"mappings":"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","file":"ManageSubjectsView.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2014-2017 ForgeRock AS.\n */\n\ndefine([\n    \"jquery\",\n    \"lodash\",\n    \"org/forgerock/openam/ui/admin/views/realms/authorization/policies/conditions/ManageRulesView\",\n    \"org/forgerock/commons/ui/common/util/Constants\"\n], function ($, _, ManageRulesView, Constants) {\n    var ManageSubjectsView = ManageRulesView.extend({\n        element: \"#subjectContainer\",\n        subEvents: {\n            \"change .subject-area .operator > select\": \"onSelect\",\n            \"mousedown #operatorSub_0 li.rule:not(.editing)\": \"setFocus\",\n            \"mousedown #operatorSub_0 li.operator:not(.editing)\": \"setFocus\",\n\n            \"click    #operatorSub_0 .rule > .item-button-panel > .fa-times\": \"onDelete\",\n            \"keyup    #operatorSub_0 .rule > .item-button-panel > .fa-times\": \"onDelete\",\n            \"click    #operatorSub_0 .rule > .item-button-panel > .fa-pencil\": \"toggleEditing\",\n            \"keyup    #operatorSub_0 .rule > .item-button-panel > .fa-pencil\": \"toggleEditing\",\n            \"click    #operatorSub_0 .rule > .item-button-panel > .fa-check\": \"toggleEditing\",\n            \"keyup    #operatorSub_0 .rule > .item-button-panel > .fa-check\": \"toggleEditing\",\n            \"dblclick #operatorSub_0 li.rule:not(.legacy-condition)\": \"toggleEditing\"\n        },\n        data: {},\n        buttons: {},\n        idCount: 0,\n        typeAND: {\n            \"title\": \"AND\",\n            \"logical\": true,\n            \"config\": {\n                \"properties\": {\n                    \"subjects\": {\n                        \"type\": \"array\",\n                        \"items\": {\n                            \"type\": \"any\"\n                        }\n                    }\n                }\n            }\n        },\n\n        render (args, callback) {\n            this.idPrefix = \"Sub_\";\n            this.property = \"subject\";\n            this.properties = \"subjects\";\n            this.data.conditionName = $.t(\"console.authorization.policies.edit.addSubjectCondition\");\n            this.data.entity = args.entity;\n            this.data.options = args.options;\n            this.data.subjects = [];\n            this.data.operators = [];\n\n            var self = this;\n\n            _.each(this.data.options.availableSubjects, function (item) {\n                if (item.logical === true) {\n                    self.data.operators.push(item);\n                } else {\n                    self.data.subjects.push(item);\n                }\n\n                delete item.config.type;\n            });\n\n            if (!_.find(this.data.operators, { title: \"AND\" })) {\n                this.data.operators.push(this.typeAND);\n            }\n\n            this.init(args, this.subEvents);\n            this.conditionType = Constants.SUBJECT;\n            this.setElement(this.element);\n\n            this.idCount = 0;\n\n            this.parentRender(function () {\n                this.buttons.addCondition = this.$el.find(\"a#addCondition\");\n                this.buttons.addOperator = this.$el.find(\"a#addOperator\");\n\n                if (self.data.operators.length === 0) {\n                    this.buttons.addOperator.hide();\n                }\n\n                this.buildList();\n                this.initSorting();\n                this.identifyDroppableLogical();\n\n                if (callback) {\n                    callback();\n                }\n            });\n        }\n    });\n\n    return new ManageSubjectsView();\n});\n"]}