{"version":3,"sources":["../../../../../../../../XUI/org/forgerock/openam/ui/admin/utils/form/bindSavePromiseToElement.js"],"names":["define","$","_","Messages","promise","element","prop","width","span","find","text","elementClass","attr","fadeOut","empty","removeClass","addClass","fadeIn","done","fail","response","addMessage","type","TYPE_DANGER","always","delay"],"mappings":";;AAAA;;;;;;;;;;;;;;;;AAgBA;;;AAGAA,OAAO,CACH,QADG,EAEH,QAFG,EAGH,qDAHG,CAAP,EAIG,UAACC,CAAD,EAAIC,CAAJ,EAAOC,QAAP;AAAA;;AAEH;;;;;;;;;;;;AAYI,kBAACC,OAAD,EAAUC,OAAV,EAAsB;AAClBA,sBAAUJ,EAAEI,OAAF,CAAV;AACAA,oBAAQC,IAAR,CAAa,UAAb,EAAyB,IAAzB;AACAD,oBAAQE,KAAR,CAAcF,QAAQE,KAAR,EAAd;;AAEA,gBAAMC,OAAOH,QAAQI,IAAR,CAAa,MAAb,CAAb;AACA,gBAAMC,OAAOF,KAAKE,IAAL,EAAb;AACA,gBAAMC,eAAeN,QAAQO,IAAR,CAAa,OAAb,CAArB;;AAEAJ,iBAAKK,OAAL,CAAa,GAAb,EAAkB,YAAM;AACpBL,qBAAKM,KAAL;AACAN,qBAAKO,WAAL,GAAmBC,QAAnB,CAA4B,uBAA5B;AACAR,qBAAKS,MAAL,CAAY,GAAZ;;AAEAb,wBAAQc,IAAR,CAAa,YAAM;AACfV,yBAAKO,WAAL,GAAmBC,QAAnB,CAA4B,mBAA5B;AACH,iBAFD,EAEGG,IAFH,CAEQ,UAACC,QAAD,EAAc;AAClBjB,6BAASkB,UAAT,CAAoB,EAAEC,MAAMnB,SAASoB,WAAjB,EAA8BH,kBAA9B,EAApB;AACAZ,yBAAKO,WAAL,GAAmBC,QAAnB,CAA4B,mBAA5B;AACAX,4BAAQU,WAAR,GAAsBC,QAAtB,CAA+B,gBAA/B;AACH,iBAND,EAMGQ,MANH,CAMU,YAAM;AACZtB,sBAAEuB,KAAF,CAAQ,YAAM;AACVjB,6BAAKK,OAAL,CAAa,GAAb,EAAkB,YAAM;AACpBL,iCAAKO,WAAL,GAAmBL,IAAnB,CAAwBA,IAAxB;AACAL,oCAAQU,WAAR,GAAsBC,QAAtB,CAA+BL,YAA/B,EAA6CL,IAA7C,CAAkD,UAAlD,EAA8D,KAA9D;AACAE,iCAAKS,MAAL,CAAY,GAAZ;AACH,yBAJD;AAKH,qBAND,EAMG,IANH;AAOH,iBAdD;AAeH,aApBD;AAqBH;AA5CF;AAAA,CAJH","file":"bindSavePromiseToElement.js","sourcesContent":["/*\n * The contents of this file are subject to the terms of the Common Development and\n * Distribution License (the License). You may not use this file except in compliance with the\n * License.\n *\n * You can obtain a copy of the License at legal/CDDLv1.0.txt. See the License for the\n * specific language governing permission and limitations under the License.\n *\n * When distributing Covered Software, include this CDDL Header Notice in each file and include\n * the License file at legal/CDDLv1.0.txt. If applicable, add the following below the CDDL\n * Header, with the fields enclosed by brackets [] replaced by your own identifying\n * information: \"Portions copyright [year] [name of copyright owner]\".\n *\n * Copyright 2016-2017 ForgeRock AS.\n */\n\n/**\n  * @module org/forgerock/openam/ui/admin/utils/form/bindSavePromiseToElement\n  */\ndefine([\n    \"jquery\",\n    \"lodash\",\n    \"org/forgerock/commons/ui/common/components/Messages\"\n], ($, _, Messages) =>\n\n/**\n      * Binds a promise representing a save to a button element, visualising it's state.\n      * <p>\n      * Intented to be used in conjunction with the <code>_JSONSchemaFooter.html</code> partial.\n      * @param  {Promise} promise Save promise. Usually a promise from an AJAX request\n      * @param  {HTMLElement} element The button element visualising the promise's state\n      * @example\n      * clickHandler: function (event) {\n      *   const promise = Service.update(this.data);\n      *   bindSavePromiseToElement(promise, event.currentTarget);\n      * }\n      */\n    (promise, element) => {\n        element = $(element);\n        element.prop(\"disabled\", true);\n        element.width(element.width());\n\n        const span = element.find(\"span\");\n        const text = span.text();\n        const elementClass = element.attr(\"class\");\n\n        span.fadeOut(300, () => {\n            span.empty();\n            span.removeClass().addClass(\"fa fa-refresh fa-spin\");\n            span.fadeIn(300);\n\n            promise.done(() => {\n                span.removeClass().addClass(\"fa fa-check fa-fw\");\n            }).fail((response) => {\n                Messages.addMessage({ type: Messages.TYPE_DANGER, response });\n                span.removeClass().addClass(\"fa fa-times fa-fw\");\n                element.removeClass().addClass(\"btn btn-danger\");\n            }).always(() => {\n                _.delay(() => {\n                    span.fadeOut(300, () => {\n                        span.removeClass().text(text);\n                        element.removeClass().addClass(elementClass).prop(\"disabled\", false);\n                        span.fadeIn(300);\n                    });\n                }, 1000);\n            });\n        });\n    }\n);\n"]}